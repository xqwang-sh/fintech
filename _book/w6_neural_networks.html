<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; ç¬¬å…­è®²ï¼šç¥ç»ç½‘ç»œåŸºç¡€ â€“ é‡‘èç§‘æŠ€æ¦‚è®ºè®²ä¹‰ï¼ˆæœºå™¨å­¦ä¹ éƒ¨åˆ†ï¼‰</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./project_list.html" rel="next">
<link href="./w5_ensemble_learning.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ed6da6eef3892af8a4b5ed59bfb951f5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "æ²¡æœ‰ç»“æœ",
    "search-matching-documents-text": "åŒ¹é…çš„æ–‡æ¡£",
    "search-copy-link-title": "å¤åˆ¶æœç´¢é“¾æ¥",
    "search-hide-matches-text": "éšè—å…¶å®ƒåŒ¹é…ç»“æœ",
    "search-more-match-text": "æ›´å¤šåŒ¹é…ç»“æœ",
    "search-more-matches-text": "æ›´å¤šåŒ¹é…ç»“æœ",
    "search-clear-button-title": "æ¸…é™¤",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "å–æ¶ˆ",
    "search-submit-button-title": "æäº¤",
    "search-label": "æœç´¢"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="å±•å¼€æˆ–æŠ˜å ä¾§è¾¹æ å¯¼èˆª" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./w6_neural_networks.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">ç¬¬å…­è®²ï¼šç¥ç»ç½‘ç»œåŸºç¡€</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="å±•å¼€æˆ–æŠ˜å ä¾§è¾¹æ å¯¼èˆª" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="æœç´¢" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">é‡‘èç§‘æŠ€æ¦‚è®ºè®²ä¹‰ï¼ˆæœºå™¨å­¦ä¹ éƒ¨åˆ†ï¼‰</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="æœç´¢"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">é‡‘èç§‘æŠ€å¯¼è®º</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./w0_syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">è¯¾ç¨‹å®‰æ’ä¸è€ƒæ ¸è¦æ±‚</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./w1_python_ml_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">ç¬¬ä¸€è®²ï¼šPythonåŸºç¡€ä¸æœºå™¨å­¦ä¹ å…¥é—¨</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./w2_data_processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">ç¬¬äºŒè®²ï¼šæ•°æ®å¤„ç†ä¸çº¿æ€§å›å½’å®è·µ</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./w3_lm_regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ç¬¬ä¸‰è®²ï¼šçº¿æ€§å›å½’çš„æ­£åˆ™åŒ–</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./w4_classification_decision_tree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ç¬¬å››è®²ï¼šåˆ†ç±»é—®é¢˜ã€å†³ç­–æ ‘ä¸è¯„ä¼°æŒ‡æ ‡</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./w5_ensemble_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ç¬¬äº”è®²ï¼šé›†æˆå­¦ä¹  - éšæœºæ£®æ—ä¸ GBDT</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./w6_neural_networks.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">ç¬¬å…­è®²ï¼šç¥ç»ç½‘ç»œåŸºç¡€</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_list.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">å…¥é—¨çº§ï¼ˆéš¾åº¦ç³»æ•° 0.9ï¼‰</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_california.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">é¡¹ç›®1ï¼šCalifornia House Prices å­¦ç”Ÿé¡¹ç›®è¦æ±‚</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_uci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">é¡¹ç›®2ï¼šUCI Credit Card Default å­¦ç”Ÿé¡¹ç›®è¦æ±‚</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_lendingclub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">é¡¹ç›®3ï¼šLending Clubï¼ˆå€Ÿè´·è¿çº¦é£é™©ï¼‰å­¦ç”Ÿé¡¹ç›®è¦æ±‚</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_homecredit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">é¡¹ç›®4ï¼šHome Credit Default Risk å­¦ç”Ÿé¡¹ç›®è¦æ±‚</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_ieee-cis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">é¡¹ç›®5ï¼šIEEEâ€‘CIS Fraud Detection å­¦ç”Ÿé¡¹ç›®è¦æ±‚</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_gresearch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">é¡¹ç›®6ï¼šGâ€‘Research Crypto Forecasting å­¦ç”Ÿé¡¹ç›®è¦æ±‚</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">ç›®å½•</h2>
   
  <ul>
  <li><a href="#å¼€åœºæ·±åº¦å­¦ä¹ çš„ç¥ç§˜é¢çº±" id="toc-å¼€åœºæ·±åº¦å­¦ä¹ çš„ç¥ç§˜é¢çº±" class="nav-link active" data-scroll-target="#å¼€åœºæ·±åº¦å­¦ä¹ çš„ç¥ç§˜é¢çº±"><span class="header-section-number">9</span> å¼€åœºï¼šæ·±åº¦å­¦ä¹ çš„ç¥ç§˜é¢çº±</a>
  <ul class="collapse">
  <li><a href="#æ·±åº¦å­¦ä¹ æ— å¤„ä¸åœ¨" id="toc-æ·±åº¦å­¦ä¹ æ— å¤„ä¸åœ¨" class="nav-link" data-scroll-target="#æ·±åº¦å­¦ä¹ æ— å¤„ä¸åœ¨"><span class="header-section-number">9.1</span> æ·±åº¦å­¦ä¹ æ— å¤„ä¸åœ¨</a></li>
  <li><a href="#æœ¬å‘¨ç›®æ ‡æ­å¼€ç¥ç§˜é¢çº±" id="toc-æœ¬å‘¨ç›®æ ‡æ­å¼€ç¥ç§˜é¢çº±" class="nav-link" data-scroll-target="#æœ¬å‘¨ç›®æ ‡æ­å¼€ç¥ç§˜é¢çº±"><span class="header-section-number">9.2</span> æœ¬å‘¨ç›®æ ‡ï¼šæ­å¼€ç¥ç§˜é¢çº±</a>
  <ul class="collapse">
  <li><a href="#çŸ¥è¯†ç›®æ ‡" id="toc-çŸ¥è¯†ç›®æ ‡" class="nav-link" data-scroll-target="#çŸ¥è¯†ç›®æ ‡"><span class="header-section-number">9.2.1</span> çŸ¥è¯†ç›®æ ‡</a></li>
  <li><a href="#æŠ€èƒ½ç›®æ ‡" id="toc-æŠ€èƒ½ç›®æ ‡" class="nav-link" data-scroll-target="#æŠ€èƒ½ç›®æ ‡"><span class="header-section-number">9.2.2</span> æŠ€èƒ½ç›®æ ‡</a></li>
  <li><a href="#æ ¸å¿ƒç†å¿µ" id="toc-æ ¸å¿ƒç†å¿µ" class="nav-link" data-scroll-target="#æ ¸å¿ƒç†å¿µ"><span class="header-section-number">9.2.3</span> æ ¸å¿ƒç†å¿µ</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ç¬¬ä¸€éƒ¨åˆ†ä»ç”Ÿç‰©åˆ°äººå·¥" id="toc-ç¬¬ä¸€éƒ¨åˆ†ä»ç”Ÿç‰©åˆ°äººå·¥" class="nav-link" data-scroll-target="#ç¬¬ä¸€éƒ¨åˆ†ä»ç”Ÿç‰©åˆ°äººå·¥"><span class="header-section-number">10</span> ç¬¬ä¸€éƒ¨åˆ†ï¼šä»ç”Ÿç‰©åˆ°äººå·¥</a>
  <ul class="collapse">
  <li><a href="#ç”Ÿç‰©ç¥ç»å…ƒ" id="toc-ç”Ÿç‰©ç¥ç»å…ƒ" class="nav-link" data-scroll-target="#ç”Ÿç‰©ç¥ç»å…ƒ"><span class="header-section-number">10.1</span> 1.1 ç”Ÿç‰©ç¥ç»å…ƒ</a>
  <ul class="collapse">
  <li><a href="#äººè„‘çš„ç¥ç»ç½‘ç»œ" id="toc-äººè„‘çš„ç¥ç»ç½‘ç»œ" class="nav-link" data-scroll-target="#äººè„‘çš„ç¥ç»ç½‘ç»œ"><span class="header-section-number">10.1.1</span> äººè„‘çš„ç¥ç»ç½‘ç»œ</a></li>
  <li><a href="#ç”Ÿç‰©ç¥ç»å…ƒçš„ç»“æ„" id="toc-ç”Ÿç‰©ç¥ç»å…ƒçš„ç»“æ„" class="nav-link" data-scroll-target="#ç”Ÿç‰©ç¥ç»å…ƒçš„ç»“æ„"><span class="header-section-number">10.1.2</span> ç”Ÿç‰©ç¥ç»å…ƒçš„ç»“æ„</a></li>
  </ul></li>
  <li><a href="#äººå·¥ç¥ç»å…ƒ" id="toc-äººå·¥ç¥ç»å…ƒ" class="nav-link" data-scroll-target="#äººå·¥ç¥ç»å…ƒ"><span class="header-section-number">10.2</span> 1.2 äººå·¥ç¥ç»å…ƒ</a>
  <ul class="collapse">
  <li><a href="#æ•°å­¦æ¨¡å‹" id="toc-æ•°å­¦æ¨¡å‹" class="nav-link" data-scroll-target="#æ•°å­¦æ¨¡å‹"><span class="header-section-number">10.2.1</span> æ•°å­¦æ¨¡å‹</a></li>
  <li><a href="#å¯è§†åŒ–äººå·¥ç¥ç»å…ƒ" id="toc-å¯è§†åŒ–äººå·¥ç¥ç»å…ƒ" class="nav-link" data-scroll-target="#å¯è§†åŒ–äººå·¥ç¥ç»å…ƒ"><span class="header-section-number">10.2.2</span> å¯è§†åŒ–äººå·¥ç¥ç»å…ƒ</a></li>
  <li><a href="#å…·ä½“ä¾‹å­titanic-ç”Ÿå­˜é¢„æµ‹" id="toc-å…·ä½“ä¾‹å­titanic-ç”Ÿå­˜é¢„æµ‹" class="nav-link" data-scroll-target="#å…·ä½“ä¾‹å­titanic-ç”Ÿå­˜é¢„æµ‹"><span class="header-section-number">10.2.3</span> å…·ä½“ä¾‹å­ï¼šTitanic ç”Ÿå­˜é¢„æµ‹</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ç¬¬äºŒéƒ¨åˆ†æ¿€æ´»å‡½æ•°" id="toc-ç¬¬äºŒéƒ¨åˆ†æ¿€æ´»å‡½æ•°" class="nav-link" data-scroll-target="#ç¬¬äºŒéƒ¨åˆ†æ¿€æ´»å‡½æ•°"><span class="header-section-number">11</span> ç¬¬äºŒéƒ¨åˆ†ï¼šæ¿€æ´»å‡½æ•°</a>
  <ul class="collapse">
  <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°" id="toc-ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°" class="nav-link" data-scroll-target="#ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°"><span class="header-section-number">11.1</span> 2.1 ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°ï¼Ÿ</a></li>
  <li><a href="#å¸¸è§æ¿€æ´»å‡½æ•°" id="toc-å¸¸è§æ¿€æ´»å‡½æ•°" class="nav-link" data-scroll-target="#å¸¸è§æ¿€æ´»å‡½æ•°"><span class="header-section-number">11.2</span> 2.2 å¸¸è§æ¿€æ´»å‡½æ•°</a>
  <ul class="collapse">
  <li><a href="#sigmoid" id="toc-sigmoid" class="nav-link" data-scroll-target="#sigmoid"><span class="header-section-number">11.2.1</span> 1. Sigmoid</a></li>
  <li><a href="#sigmoid-è¯¦è§£" id="toc-sigmoid-è¯¦è§£" class="nav-link" data-scroll-target="#sigmoid-è¯¦è§£"><span class="header-section-number">11.2.2</span> Sigmoid è¯¦è§£</a></li>
  <li><a href="#relu-è¯¦è§£" id="toc-relu-è¯¦è§£" class="nav-link" data-scroll-target="#relu-è¯¦è§£"><span class="header-section-number">11.2.3</span> ReLU è¯¦è§£</a></li>
  <li><a href="#tanh-è¯¦è§£" id="toc-tanh-è¯¦è§£" class="nav-link" data-scroll-target="#tanh-è¯¦è§£"><span class="header-section-number">11.2.4</span> Tanh è¯¦è§£</a></li>
  <li><a href="#æ¿€æ´»å‡½æ•°å¯¹æ¯”è¡¨" id="toc-æ¿€æ´»å‡½æ•°å¯¹æ¯”è¡¨" class="nav-link" data-scroll-target="#æ¿€æ´»å‡½æ•°å¯¹æ¯”è¡¨"><span class="header-section-number">11.2.5</span> æ¿€æ´»å‡½æ•°å¯¹æ¯”è¡¨</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ç¬¬ä¸‰éƒ¨åˆ†å¤šå±‚æ„ŸçŸ¥æœºmlp" id="toc-ç¬¬ä¸‰éƒ¨åˆ†å¤šå±‚æ„ŸçŸ¥æœºmlp" class="nav-link" data-scroll-target="#ç¬¬ä¸‰éƒ¨åˆ†å¤šå±‚æ„ŸçŸ¥æœºmlp"><span class="header-section-number">12</span> ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰</a>
  <ul class="collapse">
  <li><a href="#ç½‘ç»œç»“æ„" id="toc-ç½‘ç»œç»“æ„" class="nav-link" data-scroll-target="#ç½‘ç»œç»“æ„"><span class="header-section-number">12.1</span> 3.1 ç½‘ç»œç»“æ„</a>
  <ul class="collapse">
  <li><a href="#ä»å•ä¸ªç¥ç»å…ƒåˆ°ç¥ç»ç½‘ç»œ" id="toc-ä»å•ä¸ªç¥ç»å…ƒåˆ°ç¥ç»ç½‘ç»œ" class="nav-link" data-scroll-target="#ä»å•ä¸ªç¥ç»å…ƒåˆ°ç¥ç»ç½‘ç»œ"><span class="header-section-number">12.1.1</span> ä»å•ä¸ªç¥ç»å…ƒåˆ°ç¥ç»ç½‘ç»œ</a></li>
  <li><a href="#ç¬¦å·è¡¨ç¤º" id="toc-ç¬¦å·è¡¨ç¤º" class="nav-link" data-scroll-target="#ç¬¦å·è¡¨ç¤º"><span class="header-section-number">12.1.2</span> ç¬¦å·è¡¨ç¤º</a></li>
  </ul></li>
  <li><a href="#å‚æ•°æ•°é‡è®¡ç®—" id="toc-å‚æ•°æ•°é‡è®¡ç®—" class="nav-link" data-scroll-target="#å‚æ•°æ•°é‡è®¡ç®—"><span class="header-section-number">12.2</span> 3.2 å‚æ•°æ•°é‡è®¡ç®—</a>
  <ul class="collapse">
  <li><a href="#titanic-ä¾‹å­" id="toc-titanic-ä¾‹å­" class="nav-link" data-scroll-target="#titanic-ä¾‹å­"><span class="header-section-number">12.2.1</span> Titanic ä¾‹å­</a></li>
  </ul></li>
  <li><a href="#ä¸ºä»€ä¹ˆéœ€è¦å¤šå±‚" id="toc-ä¸ºä»€ä¹ˆéœ€è¦å¤šå±‚" class="nav-link" data-scroll-target="#ä¸ºä»€ä¹ˆéœ€è¦å¤šå±‚"><span class="header-section-number">12.3</span> 3.3 ä¸ºä»€ä¹ˆéœ€è¦å¤šå±‚ï¼Ÿ</a>
  <ul class="collapse">
  <li><a href="#å•å±‚çš„å±€é™æ€§" id="toc-å•å±‚çš„å±€é™æ€§" class="nav-link" data-scroll-target="#å•å±‚çš„å±€é™æ€§"><span class="header-section-number">12.3.1</span> å•å±‚çš„å±€é™æ€§</a></li>
  <li><a href="#å¤šå±‚çš„å¨åŠ›å±‚æ¬¡ç‰¹å¾å­¦ä¹ " id="toc-å¤šå±‚çš„å¨åŠ›å±‚æ¬¡ç‰¹å¾å­¦ä¹ " class="nav-link" data-scroll-target="#å¤šå±‚çš„å¨åŠ›å±‚æ¬¡ç‰¹å¾å­¦ä¹ "><span class="header-section-number">12.3.2</span> å¤šå±‚çš„å¨åŠ›ï¼šå±‚æ¬¡ç‰¹å¾å­¦ä¹ </a></li>
  <li><a href="#å±‚æ•°é€‰æ‹©å»ºè®®" id="toc-å±‚æ•°é€‰æ‹©å»ºè®®" class="nav-link" data-scroll-target="#å±‚æ•°é€‰æ‹©å»ºè®®"><span class="header-section-number">12.3.3</span> å±‚æ•°é€‰æ‹©å»ºè®®</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ç¬¬å››éƒ¨åˆ†å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­" id="toc-ç¬¬å››éƒ¨åˆ†å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­" class="nav-link" data-scroll-target="#ç¬¬å››éƒ¨åˆ†å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­"><span class="header-section-number">13</span> ç¬¬å››éƒ¨åˆ†ï¼šå‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­</a>
  <ul class="collapse">
  <li><a href="#å‰å‘ä¼ æ’­forward-propagation" id="toc-å‰å‘ä¼ æ’­forward-propagation" class="nav-link" data-scroll-target="#å‰å‘ä¼ æ’­forward-propagation"><span class="header-section-number">13.1</span> 4.1 å‰å‘ä¼ æ’­ï¼ˆForward Propagationï¼‰</a>
  <ul class="collapse">
  <li><a href="#ä»è¾“å…¥åˆ°è¾“å‡ºçš„ä¿¡æ¯æµ" id="toc-ä»è¾“å…¥åˆ°è¾“å‡ºçš„ä¿¡æ¯æµ" class="nav-link" data-scroll-target="#ä»è¾“å…¥åˆ°è¾“å‡ºçš„ä¿¡æ¯æµ"><span class="header-section-number">13.1.1</span> ä»è¾“å…¥åˆ°è¾“å‡ºçš„ä¿¡æ¯æµ</a></li>
  </ul></li>
  <li><a href="#æŸå¤±å‡½æ•°loss-function" id="toc-æŸå¤±å‡½æ•°loss-function" class="nav-link" data-scroll-target="#æŸå¤±å‡½æ•°loss-function"><span class="header-section-number">13.2</span> 4.2 æŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰</a>
  <ul class="collapse">
  <li><a href="#è¡¡é‡é¢„æµ‹è¯¯å·®" id="toc-è¡¡é‡é¢„æµ‹è¯¯å·®" class="nav-link" data-scroll-target="#è¡¡é‡é¢„æµ‹è¯¯å·®"><span class="header-section-number">13.2.1</span> è¡¡é‡é¢„æµ‹è¯¯å·®</a></li>
  <li><a href="#æŸå¤±å‡½æ•°å¯è§†åŒ–" id="toc-æŸå¤±å‡½æ•°å¯è§†åŒ–" class="nav-link" data-scroll-target="#æŸå¤±å‡½æ•°å¯è§†åŒ–"><span class="header-section-number">13.2.2</span> æŸå¤±å‡½æ•°å¯è§†åŒ–</a></li>
  </ul></li>
  <li><a href="#åå‘ä¼ æ’­backpropagation" id="toc-åå‘ä¼ æ’­backpropagation" class="nav-link" data-scroll-target="#åå‘ä¼ æ’­backpropagation"><span class="header-section-number">13.3</span> 4.3 åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰</a>
  <ul class="collapse">
  <li><a href="#æ ¸å¿ƒæ€æƒ³ä¸è®²æ•°å­¦ç»†èŠ‚" id="toc-æ ¸å¿ƒæ€æƒ³ä¸è®²æ•°å­¦ç»†èŠ‚" class="nav-link" data-scroll-target="#æ ¸å¿ƒæ€æƒ³ä¸è®²æ•°å­¦ç»†èŠ‚"><span class="header-section-number">13.3.1</span> æ ¸å¿ƒæ€æƒ³ï¼ˆä¸è®²æ•°å­¦ç»†èŠ‚ï¼‰</a></li>
  <li><a href="#ç±»æ¯”ç™»å±±ä¸‹å¡" id="toc-ç±»æ¯”ç™»å±±ä¸‹å¡" class="nav-link" data-scroll-target="#ç±»æ¯”ç™»å±±ä¸‹å¡"><span class="header-section-number">13.3.2</span> ç±»æ¯”ï¼šç™»å±±ä¸‹å¡</a></li>
  </ul></li>
  <li><a href="#ä¼˜åŒ–å™¨optimizer" id="toc-ä¼˜åŒ–å™¨optimizer" class="nav-link" data-scroll-target="#ä¼˜åŒ–å™¨optimizer"><span class="header-section-number">13.4</span> 4.4 ä¼˜åŒ–å™¨ï¼ˆOptimizerï¼‰</a>
  <ul class="collapse">
  <li><a href="#sgd-vs-adam" id="toc-sgd-vs-adam" class="nav-link" data-scroll-target="#sgd-vs-adam"><span class="header-section-number">13.4.1</span> SGD vs Adam</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#ç¬¬äº”éƒ¨åˆ†mlp-vs-æ ‘æ¨¡å‹" id="toc-ç¬¬äº”éƒ¨åˆ†mlp-vs-æ ‘æ¨¡å‹" class="nav-link" data-scroll-target="#ç¬¬äº”éƒ¨åˆ†mlp-vs-æ ‘æ¨¡å‹"><span class="header-section-number">14</span> ç¬¬äº”éƒ¨åˆ†ï¼šMLP vs æ ‘æ¨¡å‹</a>
  <ul class="collapse">
  <li><a href="#ä½•æ—¶ç”¨æ ‘æ¨¡å‹ä½•æ—¶ç”¨-mlp" id="toc-ä½•æ—¶ç”¨æ ‘æ¨¡å‹ä½•æ—¶ç”¨-mlp" class="nav-link" data-scroll-target="#ä½•æ—¶ç”¨æ ‘æ¨¡å‹ä½•æ—¶ç”¨-mlp"><span class="header-section-number">14.1</span> ä½•æ—¶ç”¨æ ‘æ¨¡å‹ï¼Œä½•æ—¶ç”¨ MLPï¼Ÿ</a>
  <ul class="collapse">
  <li><a href="#å¯¹æ¯”è¡¨" id="toc-å¯¹æ¯”è¡¨" class="nav-link" data-scroll-target="#å¯¹æ¯”è¡¨"><span class="header-section-number">14.1.1</span> å¯¹æ¯”è¡¨</a></li>
  <li><a href="#é‡‘èé¢†åŸŸå®é™…æƒ…å†µ" id="toc-é‡‘èé¢†åŸŸå®é™…æƒ…å†µ" class="nav-link" data-scroll-target="#é‡‘èé¢†åŸŸå®é™…æƒ…å†µ"><span class="header-section-number">14.1.2</span> é‡‘èé¢†åŸŸå®é™…æƒ…å†µ</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#æ€»ç»“" id="toc-æ€»ç»“" class="nav-link" data-scroll-target="#æ€»ç»“"><span class="header-section-number">15</span> æ€»ç»“</a>
  <ul class="collapse">
  <li><a href="#æœ¬è®²çŸ¥è¯†å›é¡¾" id="toc-æœ¬è®²çŸ¥è¯†å›é¡¾" class="nav-link" data-scroll-target="#æœ¬è®²çŸ¥è¯†å›é¡¾"><span class="header-section-number">15.1</span> æœ¬è®²çŸ¥è¯†å›é¡¾</a>
  <ul class="collapse">
  <li><a href="#ç¥ç»å…ƒæ¨¡å‹" id="toc-ç¥ç»å…ƒæ¨¡å‹" class="nav-link" data-scroll-target="#ç¥ç»å…ƒæ¨¡å‹"><span class="header-section-number">15.1.1</span> ç¥ç»å…ƒæ¨¡å‹</a></li>
  <li><a href="#æ¿€æ´»å‡½æ•°" id="toc-æ¿€æ´»å‡½æ•°" class="nav-link" data-scroll-target="#æ¿€æ´»å‡½æ•°"><span class="header-section-number">15.1.2</span> æ¿€æ´»å‡½æ•°</a></li>
  <li><a href="#å¤šå±‚æ„ŸçŸ¥æœº" id="toc-å¤šå±‚æ„ŸçŸ¥æœº" class="nav-link" data-scroll-target="#å¤šå±‚æ„ŸçŸ¥æœº"><span class="header-section-number">15.1.3</span> å¤šå±‚æ„ŸçŸ¥æœº</a></li>
  <li><a href="#è®­ç»ƒè¿‡ç¨‹" id="toc-è®­ç»ƒè¿‡ç¨‹" class="nav-link" data-scroll-target="#è®­ç»ƒè¿‡ç¨‹"><span class="header-section-number">15.1.4</span> è®­ç»ƒè¿‡ç¨‹</a></li>
  <li><a href="#mlp-vs-æ ‘æ¨¡å‹" id="toc-mlp-vs-æ ‘æ¨¡å‹" class="nav-link" data-scroll-target="#mlp-vs-æ ‘æ¨¡å‹"><span class="header-section-number">15.1.5</span> MLP vs æ ‘æ¨¡å‹</a></li>
  </ul></li>
  <li><a href="#æ ¸å¿ƒè¦ç‚¹" id="toc-æ ¸å¿ƒè¦ç‚¹" class="nav-link" data-scroll-target="#æ ¸å¿ƒè¦ç‚¹"><span class="header-section-number">15.2</span> æ ¸å¿ƒè¦ç‚¹</a></li>
  </ul></li>
  <li><a href="#qa" id="toc-qa" class="nav-link" data-scroll-target="#qa"><span class="header-section-number">16</span> Q&amp;A</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">ç¬¬å…­è®²ï¼šç¥ç»ç½‘ç»œåŸºç¡€</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="198441d2" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>ä»£ç </summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># æ ¹æ®æ“ä½œç³»ç»Ÿè®¾ç½®ä¸åŒçš„å­—ä½“</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> platform</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># è·å–æ“ä½œç³»ç»Ÿç±»å‹</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>system <span class="op">=</span> platform.system()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># è®¾ç½® matplotlib å­—ä½“</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> system <span class="op">==</span> <span class="st">'Windows'</span>:</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    plt.rcParams[<span class="st">'font.sans-serif'</span>] <span class="op">=</span> [<span class="st">'SimHei'</span>]  <span class="co"># Windows ä½¿ç”¨é»‘ä½“</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> system <span class="op">==</span> <span class="st">'Darwin'</span>:</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    plt.rcParams[<span class="st">'font.sans-serif'</span>] <span class="op">=</span> [<span class="st">'Songti SC'</span>]  <span class="co"># Mac ä½¿ç”¨å®‹ä½“</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    plt.rcParams[<span class="st">'font.sans-serif'</span>] <span class="op">=</span> [<span class="st">'WenQuanYi Zen Hei'</span>]  <span class="co"># Linux ä½¿ç”¨æ–‡æ³‰é©¿æ­£é»‘</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># è§£å†³è´Ÿå·æ˜¾ç¤ºé—®é¢˜</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.unicode_minus'</span>] <span class="op">=</span> <span class="va">False</span></span></code><button title="å¤åˆ¶åˆ°å‰ªè´´æ¿" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="å¼€åœºæ·±åº¦å­¦ä¹ çš„ç¥ç§˜é¢çº±" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> å¼€åœºï¼šæ·±åº¦å­¦ä¹ çš„ç¥ç§˜é¢çº±</h1>
<hr>
<section id="æ·±åº¦å­¦ä¹ æ— å¤„ä¸åœ¨" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="æ·±åº¦å­¦ä¹ æ— å¤„ä¸åœ¨"><span class="header-section-number">9.1</span> æ·±åº¦å­¦ä¹ æ— å¤„ä¸åœ¨</h2>
<p><strong>ä½ æ¯å¤©éƒ½åœ¨ä½¿ç”¨æ·±åº¦å­¦ä¹ </strong>ï¼š</p>
<ul>
<li>ğŸ“± æ‰‹æœºäººè„¸è§£é”</li>
<li>ğŸ—£ï¸ è¯­éŸ³åŠ©æ‰‹ï¼ˆSiriã€å°çˆ±ï¼‰</li>
<li>ğŸ“· æ‹ç…§ç¾é¢œ</li>
<li>ğŸš— è‡ªåŠ¨é©¾é©¶</li>
<li>ğŸ’¬ ChatGPT</li>
</ul>
<p><strong>é—®é¢˜</strong>ï¼šè¿™äº›â€é»‘ç§‘æŠ€â€çš„åº•å±‚åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><strong>ç­”æ¡ˆ</strong>ï¼š<strong>ç¥ç»ç½‘ç»œ</strong></p>
<hr>
</section>
<section id="æœ¬å‘¨ç›®æ ‡æ­å¼€ç¥ç§˜é¢çº±" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="æœ¬å‘¨ç›®æ ‡æ­å¼€ç¥ç§˜é¢çº±"><span class="header-section-number">9.2</span> æœ¬å‘¨ç›®æ ‡ï¼šæ­å¼€ç¥ç§˜é¢çº±</h2>
<section id="çŸ¥è¯†ç›®æ ‡" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="çŸ¥è¯†ç›®æ ‡"><span class="header-section-number">9.2.1</span> çŸ¥è¯†ç›®æ ‡</h3>
<ol type="1">
<li>ç†è§£ç¥ç»å…ƒçš„åŸºæœ¬æ¦‚å¿µ</li>
<li>ç†è§£å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰çš„ç½‘ç»œç»“æ„</li>
<li>äº†è§£å¸¸è§æ¿€æ´»å‡½æ•°ï¼ˆReLUã€Sigmoidã€Tanhï¼‰</li>
<li>ç†è§£å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­çš„ç›´è§‰</li>
<li>çŸ¥é“ä½•æ—¶ç”¨æ ‘æ¨¡å‹ vs ç¥ç»ç½‘ç»œ</li>
</ol>
</section>
<section id="æŠ€èƒ½ç›®æ ‡" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="æŠ€èƒ½ç›®æ ‡"><span class="header-section-number">9.2.2</span> æŠ€èƒ½ç›®æ ‡</h3>
<ol type="1">
<li>ä½¿ç”¨ Keras æ­å»ºç®€å•çš„ MLP</li>
<li>è®­ç»ƒ MLP å¹¶å¯è§†åŒ–å­¦ä¹ æ›²çº¿</li>
<li>åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼° MLP çš„ AUC</li>
<li>è°ƒæ•´ç½‘ç»œç»“æ„ï¼ˆå±‚æ•°ã€ç¥ç»å…ƒæ•°é‡ï¼‰</li>
</ol>
<hr>
</section>
<section id="æ ¸å¿ƒç†å¿µ" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="æ ¸å¿ƒç†å¿µ"><span class="header-section-number">9.2.3</span> æ ¸å¿ƒç†å¿µ</h3>
<p><strong>æ·±åº¦å­¦ä¹ ä¸ç¥ç§˜</strong></p>
<ul>
<li>å®ƒæ˜¯åŸºäºç®€å•æ•°å­¦è¿ç®—çš„ç´¯ç§¯</li>
<li>å…³é”®æ˜¯â€å­¦ä¹ â€ï¼šé€šè¿‡æ•°æ®è‡ªåŠ¨è°ƒæ•´å‚æ•°</li>
<li>ä¸è¦è¢«å¤æ‚çš„å…¬å¼å“å€’ï¼Œå…ˆå»ºç«‹ç›´è§‰ï¼</li>
</ul>
<hr>
</section>
</section>
</section>
<section id="ç¬¬ä¸€éƒ¨åˆ†ä»ç”Ÿç‰©åˆ°äººå·¥" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> ç¬¬ä¸€éƒ¨åˆ†ï¼šä»ç”Ÿç‰©åˆ°äººå·¥</h1>
<hr>
<section id="ç”Ÿç‰©ç¥ç»å…ƒ" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="ç”Ÿç‰©ç¥ç»å…ƒ"><span class="header-section-number">10.1</span> 1.1 ç”Ÿç‰©ç¥ç»å…ƒ</h2>
<section id="äººè„‘çš„ç¥ç»ç½‘ç»œ" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="äººè„‘çš„ç¥ç»ç½‘ç»œ"><span class="header-section-number">10.1.1</span> äººè„‘çš„ç¥ç»ç½‘ç»œ</h3>
<ul>
<li>äººè„‘çº¦æœ‰ <strong>860 äº¿ä¸ªç¥ç»å…ƒ</strong></li>
<li>æ¯ä¸ªç¥ç»å…ƒè¿æ¥ <strong>æ•°åƒåˆ°ä¸Šä¸‡ä¸ª</strong>å…¶ä»–ç¥ç»å…ƒ</li>
<li>é€šè¿‡<strong>ç”µä¿¡å·</strong>ä¼ é€’ä¿¡æ¯</li>
<li>å­¦ä¹  = è°ƒæ•´ç¥ç»å…ƒä¹‹é—´çš„<strong>è¿æ¥å¼ºåº¦</strong></li>
</ul>
<hr>
</section>
<section id="ç”Ÿç‰©ç¥ç»å…ƒçš„ç»“æ„" class="level3" data-number="10.1.2">
<h3 data-number="10.1.2" class="anchored" data-anchor-id="ç”Ÿç‰©ç¥ç»å…ƒçš„ç»“æ„"><span class="header-section-number">10.1.2</span> ç”Ÿç‰©ç¥ç»å…ƒçš„ç»“æ„</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[æ ‘çª&lt;br/&gt;Dendrites&lt;br/&gt;æ¥æ”¶ä¿¡å·] --&gt; B[ç»†èƒä½“&lt;br/&gt;Soma&lt;br/&gt;æ•´åˆå¤„ç†]
    B --&gt; C[è½´çª&lt;br/&gt;Axon&lt;br/&gt;è¾“å‡ºä¿¡å·]
    C --&gt; D[çªè§¦&lt;br/&gt;Synapse&lt;br/&gt;è¿æ¥ä¸‹ä¸€ä¸ªç¥ç»å…ƒ]
    
    style A fill:#fff9c4
    style B fill:#c8e6c9
    style C fill:#bbdefb
    style D fill:#ffccbc
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>å…³é”®è¿‡ç¨‹</strong>ï¼š</p>
<ol type="1">
<li>æ ‘çªæ¥æ”¶å¤šä¸ªè¾“å…¥ä¿¡å·</li>
<li>ç»†èƒä½“å¯¹ä¿¡å·è¿›è¡Œ<strong>åŠ æƒæ±‚å’Œ</strong></li>
<li>å¦‚æœæ€»å’Œè¶…è¿‡<strong>é˜ˆå€¼</strong>ï¼Œç¥ç»å…ƒâ€å‘ç«â€ï¼ˆæ¿€æ´»ï¼‰</li>
<li>é€šè¿‡è½´çªä¼ é€’ä¿¡å·ç»™ä¸‹ä¸€ä¸ªç¥ç»å…ƒ</li>
</ol>
<hr>
</section>
</section>
<section id="äººå·¥ç¥ç»å…ƒ" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="äººå·¥ç¥ç»å…ƒ"><span class="header-section-number">10.2</span> 1.2 äººå·¥ç¥ç»å…ƒ</h2>
<section id="æ•°å­¦æ¨¡å‹" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="æ•°å­¦æ¨¡å‹"><span class="header-section-number">10.2.1</span> æ•°å­¦æ¨¡å‹</h3>
<p><strong>ç®€åŒ–çš„ç¥ç»å…ƒæ¨¡å‹ï¼ˆ1943å¹´ï¼ŒMcCulloch &amp; Pittsï¼‰</strong>ï¼š</p>
<p><span class="math display">\[
y = f\left(\sum_{i=1}^{n} w_i x_i + b\right)
\]</span></p>
<p><strong>ç»„æˆéƒ¨åˆ†</strong>ï¼š</p>
<ul>
<li><span class="math inline">\(x_i\)</span>ï¼šè¾“å…¥ä¿¡å·ï¼ˆç‰¹å¾ï¼‰</li>
<li><span class="math inline">\(w_i\)</span>ï¼šæƒé‡ï¼ˆè¿æ¥å¼ºåº¦ï¼‰</li>
<li><span class="math inline">\(b\)</span>ï¼šåç½®ï¼ˆé˜ˆå€¼ï¼‰</li>
<li><span class="math inline">\(f\)</span>ï¼šæ¿€æ´»å‡½æ•°ï¼ˆå†³å®šæ˜¯å¦â€å‘ç«â€ï¼‰</li>
<li><span class="math inline">\(y\)</span>ï¼šè¾“å‡º</li>
</ul>
<hr>
</section>
<section id="å¯è§†åŒ–äººå·¥ç¥ç»å…ƒ" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="å¯è§†åŒ–äººå·¥ç¥ç»å…ƒ"><span class="header-section-number">10.2.2</span> å¯è§†åŒ–äººå·¥ç¥ç»å…ƒ</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    X1[xâ‚] --&gt;|wâ‚| S((Î£))
    X2[xâ‚‚] --&gt;|wâ‚‚| S
    X3[xâ‚ƒ] --&gt;|wâ‚ƒ| S
    B[+b] --&gt; S
    S --&gt; F[æ¿€æ´»å‡½æ•°&lt;br/&gt;f]
    F --&gt; Y[y]
    
    style S fill:#fff9c4
    style F fill:#c8e6c9
    style Y fill:#4caf50,color:#fff
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>æ­¥éª¤ 1ï¼šåŠ æƒæ±‚å’Œ</strong></p>
<p><span class="math display">\[
z = w_1 x_1 + w_2 x_2 + w_3 x_3 + b
\]</span></p>
<p><strong>æ­¥éª¤ 2ï¼šæ¿€æ´»</strong></p>
<p><span class="math display">\[
y = f(z)
\]</span></p>
<hr>
</section>
<section id="å…·ä½“ä¾‹å­titanic-ç”Ÿå­˜é¢„æµ‹" class="level3" data-number="10.2.3">
<h3 data-number="10.2.3" class="anchored" data-anchor-id="å…·ä½“ä¾‹å­titanic-ç”Ÿå­˜é¢„æµ‹"><span class="header-section-number">10.2.3</span> å…·ä½“ä¾‹å­ï¼šTitanic ç”Ÿå­˜é¢„æµ‹</h3>
<p><strong>ç‰¹å¾</strong>ï¼š</p>
<ul>
<li><span class="math inline">\(x_1\)</span> = æ€§åˆ«ï¼ˆ1=ç”·ï¼Œ0=å¥³ï¼‰</li>
<li><span class="math inline">\(x_2\)</span> = å¹´é¾„</li>
<li><span class="math inline">\(x_3\)</span> = ç¥¨ä»·</li>
</ul>
<p><strong>å‡è®¾æƒé‡</strong>ï¼š</p>
<ul>
<li><span class="math inline">\(w_1 = -2\)</span>ï¼ˆæ€§åˆ«è¶Šç”·è¶Šä¸åˆ©ï¼‰</li>
<li><span class="math inline">\(w_2 = -0.01\)</span>ï¼ˆå¹´é¾„è¶Šå¤§è¶Šä¸åˆ©ï¼‰</li>
<li><span class="math inline">\(w_3 = 0.001\)</span>ï¼ˆç¥¨ä»·è¶Šé«˜è¶Šæœ‰åˆ©ï¼‰</li>
<li><span class="math inline">\(b = 1\)</span>ï¼ˆåŸºç¡€åç½®ï¼‰</li>
</ul>
<hr>
<p><strong>è®¡ç®—è¿‡ç¨‹</strong>ï¼š</p>
<pre><code>ç”·æ€§ä¹˜å®¢ï¼šxâ‚=1, xâ‚‚=25, xâ‚ƒ=50
z = (-2)Ã—1 + (-0.01)Ã—25 + 0.001Ã—50 + 1
  = -2 - 0.25 + 0.05 + 1
  = -1.2

ç»è¿‡ Sigmoid æ¿€æ´»ï¼š
y = 1/(1+e^1.2) â‰ˆ 0.23

è§£é‡Šï¼šå­˜æ´»æ¦‚ç‡ 23%ï¼ˆè¾ƒä½ï¼‰</code></pre>
<p><strong>æƒé‡çš„å«ä¹‰</strong>ï¼š</p>
<ul>
<li><span class="math inline">\(w_1 = -2\)</span>ï¼šæ€§åˆ«å¯¹ç”Ÿå­˜å½±å“æœ€å¤§</li>
<li>è´Ÿæƒé‡è¡¨ç¤ºè´Ÿç›¸å…³</li>
<li>æƒé‡çš„ç»å¯¹å€¼è¡¨ç¤ºé‡è¦æ€§</li>
</ul>
<hr>
</section>
</section>
</section>
<section id="ç¬¬äºŒéƒ¨åˆ†æ¿€æ´»å‡½æ•°" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> ç¬¬äºŒéƒ¨åˆ†ï¼šæ¿€æ´»å‡½æ•°</h1>
<hr>
<section id="ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°"><span class="header-section-number">11.1</span> 2.1 ä¸ºä»€ä¹ˆéœ€è¦æ¿€æ´»å‡½æ•°ï¼Ÿ</h2>
<p><strong>æ²¡æœ‰æ¿€æ´»å‡½æ•°çš„é—®é¢˜</strong>ï¼š</p>
<p><span class="math display">\[
\begin{align}
\text{å±‚1: } &amp;h_1 = W_1 x + b_1 \\
\text{å±‚2: } &amp;h_2 = W_2 h_1 + b_2 = W_2(W_1 x + b_1) + b_2 \\
&amp;= (W_2 W_1) x + (W_2 b_1 + b_2) \\
&amp;= W' x + b' \quad \text{ï¼ˆä»ç„¶æ˜¯çº¿æ€§ï¼‰}
\end{align}
\]</span></p>
<p><strong>ç»“è®º</strong>ï¼šå¤šå±‚çº¿æ€§å åŠ  = å•å±‚çº¿æ€§</p>
<p><strong>æ¿€æ´»å‡½æ•°çš„ä½œç”¨</strong>ï¼š<strong>å¼•å…¥éçº¿æ€§</strong>ï¼Œè®©ç½‘ç»œèƒ½å­¦ä¹ å¤æ‚æ¨¡å¼</p>
<hr>
</section>
<section id="å¸¸è§æ¿€æ´»å‡½æ•°" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="å¸¸è§æ¿€æ´»å‡½æ•°"><span class="header-section-number">11.2</span> 2.2 å¸¸è§æ¿€æ´»å‡½æ•°</h2>
<section id="sigmoid" class="level3" data-number="11.2.1">
<h3 data-number="11.2.1" class="anchored" data-anchor-id="sigmoid"><span class="header-section-number">11.2.1</span> 1. Sigmoid</h3>
<p><span class="math display">\[
\sigma(z) = \frac{1}{1 + e^{-z}}
\]</span></p>
<div id="49a3d44f" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>ä»£ç </summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">100</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>sigmoid <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>z))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>relu <span class="op">=</span> np.maximum(<span class="dv">0</span>, z)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>tanh <span class="op">=</span> np.tanh(z)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sigmoid</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(z, sigmoid, linewidth<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">'#2196f3'</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axhline(y<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'z'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'Ïƒ(z)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'Sigmoid</span><span class="ch">\n</span><span class="st">Ïƒ(z) = 1/(1+eâ»á¶»)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].text(<span class="dv">3</span>, <span class="fl">0.5</span>, <span class="st">'è¾“å‡º: (0, 1)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'wheat'</span>))</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ReLU</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(z, relu, linewidth<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">'#4caf50'</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'z'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'ReLU(z)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'ReLU</span><span class="ch">\n</span><span class="st">ReLU(z) = max(0, z)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].text(<span class="dv">3</span>, <span class="dv">3</span>, <span class="st">'è¾“å‡º: [0, âˆ)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'wheat'</span>))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Tanh</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(z, tanh, linewidth<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">'#ff9800'</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].axhline(y<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].axhline(y<span class="op">=-</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xlabel(<span class="st">'z'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylabel(<span class="st">'tanh(z)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_title(<span class="st">'Tanh</span><span class="ch">\n</span><span class="st">tanh(z) = (eá¶»-eâ»á¶»)/(eá¶»+eâ»á¶»)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylim(<span class="op">-</span><span class="fl">1.1</span>, <span class="fl">1.1</span>)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].text(<span class="dv">3</span>, <span class="dv">0</span>, <span class="st">'è¾“å‡º: (-1, 1)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'wheat'</span>))</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="å¤åˆ¶åˆ°å‰ªè´´æ¿" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_37997/1535391376.py:48: UserWarning:

Glyph 8315 (\N{SUPERSCRIPT MINUS}) missing from current font.

/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_37997/1535391376.py:48: UserWarning:

Glyph 7611 (\N{MODIFIER LETTER SMALL Z}) missing from current font.

/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:

Glyph 8315 (\N{SUPERSCRIPT MINUS}) missing from current font.

/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:

Glyph 7611 (\N{MODIFIER LETTER SMALL Z}) missing from current font.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="w6_neural_networks_files/figure-html/cell-3-output-2.png" width="1429" height="472" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="sigmoid-è¯¦è§£" class="level3" data-number="11.2.2">
<h3 data-number="11.2.2" class="anchored" data-anchor-id="sigmoid-è¯¦è§£"><span class="header-section-number">11.2.2</span> Sigmoid è¯¦è§£</h3>
<p><strong>å…¬å¼</strong>ï¼š</p>
<p><span class="math display">\[
\sigma(z) = \frac{1}{1 + e^{-z}}
\]</span></p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>è¾“å‡ºèŒƒå›´ï¼š(0, 1)</li>
<li>S å½¢æ›²çº¿ï¼Œå¹³æ»‘</li>
<li>å¯è§£é‡Šä¸º<strong>æ¦‚ç‡</strong></li>
</ul>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>è¾“å‡ºæœ‰ç•Œï¼Œç¨³å®š</li>
<li>é€‚åˆäºŒåˆ†ç±»è¾“å‡ºå±‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æ¢¯åº¦æ¶ˆå¤±</strong>ï¼šå½“ <span class="math inline">\(|z|\)</span> å¾ˆå¤§æ—¶ï¼Œæ¢¯åº¦æ¥è¿‘ 0</li>
<li>è®¡ç®—æˆæœ¬é«˜ï¼ˆæŒ‡æ•°è¿ç®—ï¼‰</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>âœ“ äºŒåˆ†ç±»é—®é¢˜çš„<strong>è¾“å‡ºå±‚</strong></li>
<li>âœ— éšè—å±‚ï¼ˆå·²è¢« ReLU å–ä»£ï¼‰</li>
</ul>
<hr>
</section>
<section id="relu-è¯¦è§£" class="level3" data-number="11.2.3">
<h3 data-number="11.2.3" class="anchored" data-anchor-id="relu-è¯¦è§£"><span class="header-section-number">11.2.3</span> ReLU è¯¦è§£</h3>
<p><strong>å…¬å¼</strong>ï¼š</p>
<p><span class="math display">\[
\text{ReLU}(z) = \max(0, z) = \begin{cases}
z &amp; \text{if } z &gt; 0 \\
0 &amp; \text{if } z \leq 0
\end{cases}
\]</span></p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>âš¡ <strong>è®¡ç®—è¶…å¿«</strong>ï¼ˆåªæ˜¯æ¯”è¾ƒå’Œé€‰æ‹©ï¼‰</li>
<li>ğŸ¯ ç¼“è§£æ¢¯åº¦æ¶ˆå¤±ï¼ˆ<span class="math inline">\(z&gt;0\)</span> æ—¶æ¢¯åº¦æ’ä¸º 1ï¼‰</li>
<li>ğŸ§  ç”Ÿç‰©å­¦åˆç†æ€§ï¼ˆç¥ç»å…ƒè¦ä¹ˆæ¿€æ´»è¦ä¹ˆä¸æ¿€æ´»ï¼‰</li>
<li>ğŸ“Š ç¨€ç–æ¿€æ´»ï¼ˆçº¦ 50% ç¥ç»å…ƒè¾“å‡º 0ï¼‰</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>ğŸ’€ <strong>â€œç¥ç»å…ƒæ­»äº¡â€</strong>ï¼šæŸäº›ç¥ç»å…ƒå¯èƒ½æ°¸è¿œè¾“å‡º 0</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>âœ“ <strong>éšè—å±‚é¦–é€‰</strong></li>
<li>âœ“ ç»å¤§å¤šæ•°æ·±åº¦å­¦ä¹ ä»»åŠ¡</li>
</ul>
<hr>
</section>
<section id="tanh-è¯¦è§£" class="level3" data-number="11.2.4">
<h3 data-number="11.2.4" class="anchored" data-anchor-id="tanh-è¯¦è§£"><span class="header-section-number">11.2.4</span> Tanh è¯¦è§£</h3>
<p><strong>å…¬å¼</strong>ï¼š</p>
<p><span class="math display">\[
\tanh(z) = \frac{e^z - e^{-z}}{e^z + e^{-z}}
\]</span></p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>è¾“å‡ºèŒƒå›´ï¼š(-1, 1)</li>
<li><strong>é›¶ä¸­å¿ƒ</strong>ï¼ˆSigmoid ä¸æ˜¯ï¼‰</li>
<li>æ¯” Sigmoid æ›´é™¡</li>
</ul>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>é›¶ä¸­å¿ƒ â†’ æ”¶æ•›æ›´å¿«</li>
<li>è¾“å‡ºèŒƒå›´å¯¹ç§°</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>ä»æœ‰æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</li>
<li>è®¡ç®—æˆæœ¬é«˜</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰</li>
<li>éœ€è¦é›¶ä¸­å¿ƒè¾“å‡ºçš„åœºæ™¯</li>
</ul>
<hr>
</section>
<section id="æ¿€æ´»å‡½æ•°å¯¹æ¯”è¡¨" class="level3" data-number="11.2.5">
<h3 data-number="11.2.5" class="anchored" data-anchor-id="æ¿€æ´»å‡½æ•°å¯¹æ¯”è¡¨"><span class="header-section-number">11.2.5</span> æ¿€æ´»å‡½æ•°å¯¹æ¯”è¡¨</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>æ¿€æ´»å‡½æ•°</th>
<th>èŒƒå›´</th>
<th>ä¼˜ç‚¹</th>
<th>ç¼ºç‚¹</th>
<th>ä¸»è¦ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Sigmoid</strong></td>
<td>(0, 1)</td>
<td>æ¦‚ç‡è§£é‡Š<br>å¹³æ»‘</td>
<td>æ¢¯åº¦æ¶ˆå¤±<br>è®¡ç®—æ…¢</td>
<td>äºŒåˆ†ç±»è¾“å‡ºå±‚</td>
</tr>
<tr class="even">
<td><strong>ReLU</strong></td>
<td>[0, âˆ)</td>
<td>å¿«é€Ÿ<br>ç¼“è§£æ¢¯åº¦æ¶ˆå¤±</td>
<td>ç¥ç»å…ƒæ­»äº¡</td>
<td><strong>éšè—å±‚é¦–é€‰</strong></td>
</tr>
<tr class="odd">
<td><strong>Tanh</strong></td>
<td>(-1, 1)</td>
<td>é›¶ä¸­å¿ƒ<br>å¯¹ç§°</td>
<td>æ¢¯åº¦æ¶ˆå¤±<br>è®¡ç®—æ…¢</td>
<td>RNN</td>
</tr>
</tbody>
</table>
<p><strong>ç»éªŒæ³•åˆ™</strong>ï¼š</p>
<ul>
<li>éšè—å±‚ï¼š<strong>ä¼˜å…ˆé€‰ ReLU</strong></li>
<li>è¾“å‡ºå±‚ï¼š
<ul>
<li>äºŒåˆ†ç±» â†’ Sigmoid</li>
<li>å¤šåˆ†ç±» â†’ Softmaxï¼ˆåç»­ä¼šå­¦ï¼‰</li>
<li>å›å½’ â†’ ä¸ç”¨æ¿€æ´»ï¼ˆçº¿æ€§è¾“å‡ºï¼‰</li>
</ul></li>
</ul>
<hr>
</section>
</section>
</section>
<section id="ç¬¬ä¸‰éƒ¨åˆ†å¤šå±‚æ„ŸçŸ¥æœºmlp" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰</h1>
<hr>
<section id="ç½‘ç»œç»“æ„" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="ç½‘ç»œç»“æ„"><span class="header-section-number">12.1</span> 3.1 ç½‘ç»œç»“æ„</h2>
<section id="ä»å•ä¸ªç¥ç»å…ƒåˆ°ç¥ç»ç½‘ç»œ" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="ä»å•ä¸ªç¥ç»å…ƒåˆ°ç¥ç»ç½‘ç»œ"><span class="header-section-number">12.1.1</span> ä»å•ä¸ªç¥ç»å…ƒåˆ°ç¥ç»ç½‘ç»œ</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    subgraph è¾“å…¥å±‚
    X1[ç‰¹å¾1]
    X2[ç‰¹å¾2]
    X3[ç‰¹å¾3]
    end
    subgraph éšè—å±‚1
    H11[ç¥ç»å…ƒ1]
    H12[ç¥ç»å…ƒ2]
    H13[ç¥ç»å…ƒ3]
    H14[ç¥ç»å…ƒ4]
    end
    subgraph éšè—å±‚2
    H21[ç¥ç»å…ƒ1]
    H22[ç¥ç»å…ƒ2]
    end
    subgraph è¾“å‡ºå±‚
    Y[é¢„æµ‹]
    end

    X1 --&gt; H11
    X1 --&gt; H12
    X1 --&gt; H13
    X1 --&gt; H14
    X2 --&gt; H11
    X2 --&gt; H12
    X2 --&gt; H13
    X2 --&gt; H14
    X3 --&gt; H11
    X3 --&gt; H12
    X3 --&gt; H13
    X3 --&gt; H14

    H11 --&gt; H21
    H11 --&gt; H22
    H12 --&gt; H21
    H12 --&gt; H22
    H13 --&gt; H21
    H13 --&gt; H22
    H14 --&gt; H21
    H14 --&gt; H22

    H21 --&gt; Y
    H22 --&gt; Y

    style X1 fill:#fff9c4
    style X2 fill:#fff9c4
    style X3 fill:#fff9c4
    style H11 fill:#c8e6c9
    style H12 fill:#c8e6c9
    style H13 fill:#c8e6c9
    style H14 fill:#c8e6c9
    style H21 fill:#bbdefb
    style H22 fill:#bbdefb
    style Y fill:#4caf50,color:#fff
    %% subgraph èƒŒæ™¯è‰²ç¾åŒ–
    style è¾“å…¥å±‚ fill:#f8f9fa,stroke:#e0e0e0
    style éšè—å±‚1 fill:#f1f8e9,stroke:#aed581
    style éšè—å±‚2 fill:#e3f2fd,stroke:#90caf9
    style è¾“å‡ºå±‚ fill:#fce4ec,stroke:#f06292
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
<section id="ç¬¦å·è¡¨ç¤º" class="level3" data-number="12.1.2">
<h3 data-number="12.1.2" class="anchored" data-anchor-id="ç¬¦å·è¡¨ç¤º"><span class="header-section-number">12.1.2</span> ç¬¦å·è¡¨ç¤º</h3>
<p><strong>è¾“å…¥å±‚ â†’ éšè—å±‚1 â†’ éšè—å±‚2 â†’ è¾“å‡ºå±‚</strong></p>
<ul>
<li>è¾“å…¥ï¼š3 ä¸ªç‰¹å¾</li>
<li>éšè—å±‚1ï¼š4 ä¸ªç¥ç»å…ƒï¼ˆReLUï¼‰</li>
<li>éšè—å±‚2ï¼š2 ä¸ªç¥ç»å…ƒï¼ˆReLUï¼‰</li>
<li>è¾“å‡ºå±‚ï¼š1 ä¸ªç¥ç»å…ƒï¼ˆSigmoidï¼‰</li>
</ul>
<p><strong>ç®€å†™</strong>ï¼š<code>Input(3) â†’ [4] â†’ [2] â†’ Output(1)</code></p>
<hr>
</section>
</section>
<section id="å‚æ•°æ•°é‡è®¡ç®—" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="å‚æ•°æ•°é‡è®¡ç®—"><span class="header-section-number">12.2</span> 3.2 å‚æ•°æ•°é‡è®¡ç®—</h2>
<section id="titanic-ä¾‹å­" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="titanic-ä¾‹å­"><span class="header-section-number">12.2.1</span> Titanic ä¾‹å­</h3>
<pre><code>Input(8) â†’ Dense(64, ReLU) â†’ Dense(32, ReLU) â†’ Output(1, Sigmoid)</code></pre>
<p><strong>è®¡ç®—</strong>ï¼š</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>å±‚</th>
<th>å‚æ•°æ•°é‡</th>
<th>è®¡ç®—</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>è¾“å…¥ â†’ éšè—1</td>
<td>8Ã—64 + 64 = <strong>576</strong></td>
<td>æƒé‡ + åç½®</td>
</tr>
<tr class="even">
<td>éšè—1 â†’ éšè—2</td>
<td>64Ã—32 + 32 = <strong>2,080</strong></td>
<td>æƒé‡ + åç½®</td>
</tr>
<tr class="odd">
<td>éšè—2 â†’ è¾“å‡º</td>
<td>32Ã—1 + 1 = <strong>33</strong></td>
<td>æƒé‡ + åç½®</td>
</tr>
<tr class="even">
<td><strong>æ€»è®¡</strong></td>
<td><strong>2,689</strong></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>å¯¹æ¯”</strong>ï¼š</p>
<ul>
<li>å†³ç­–æ ‘ï¼šåªæœ‰åˆ†è£‚è§„åˆ™ï¼ˆå°‘é‡å‚æ•°ï¼‰</li>
<li>MLPï¼š<strong>æ•°åƒä¸ªå‚æ•°éœ€è¦å­¦ä¹ </strong></li>
</ul>
<hr>
</section>
</section>
<section id="ä¸ºä»€ä¹ˆéœ€è¦å¤šå±‚" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="ä¸ºä»€ä¹ˆéœ€è¦å¤šå±‚"><span class="header-section-number">12.3</span> 3.3 ä¸ºä»€ä¹ˆéœ€è¦å¤šå±‚ï¼Ÿ</h2>
<section id="å•å±‚çš„å±€é™æ€§" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="å•å±‚çš„å±€é™æ€§"><span class="header-section-number">12.3.1</span> å•å±‚çš„å±€é™æ€§</h3>
<p><strong>å•å±‚ç¥ç»ç½‘ç»œ</strong>ï¼ˆ= é€»è¾‘å›å½’ï¼‰ï¼š</p>
<ul>
<li>åªèƒ½å­¦ä¹ <strong>çº¿æ€§å†³ç­–è¾¹ç•Œ</strong></li>
<li>æ— æ³•è§£å†³ XOR é—®é¢˜</li>
</ul>
<div id="4a7806c5" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>ä»£ç </summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># XOR é—®é¢˜ç¤ºä¾‹</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># XOR æ•°æ®</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>X_xor <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">1</span>]])</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>y_xor <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># å•å±‚æ— æ³•åˆ†ç±»</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter(X_xor[y_xor<span class="op">==</span><span class="dv">0</span>, <span class="dv">0</span>], X_xor[y_xor<span class="op">==</span><span class="dv">0</span>, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">200</span>, c<span class="op">=</span><span class="st">'red'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">'ç±»åˆ« 0'</span>, edgecolors<span class="op">=</span><span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter(X_xor[y_xor<span class="op">==</span><span class="dv">1</span>, <span class="dv">0</span>], X_xor[y_xor<span class="op">==</span><span class="dv">1</span>, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">200</span>, c<span class="op">=</span><span class="st">'blue'</span>, marker<span class="op">=</span><span class="st">'s'</span>, label<span class="op">=</span><span class="st">'ç±»åˆ« 1'</span>, edgecolors<span class="op">=</span><span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="fl">0.5</span>, <span class="fl">0.5</span>], <span class="st">'k--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'çº¿æ€§è¾¹ç•Œï¼Ÿ'</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">'xâ‚'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">'xâ‚‚'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">'XOR é—®é¢˜ï¼šå•å±‚ç½‘ç»œæ— æ³•è§£å†³'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].legend(fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlim(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># å¤šå±‚å¯ä»¥åˆ†ç±»</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPClassifier</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>mlp_xor <span class="op">=</span> MLPClassifier(hidden_layer_sizes<span class="op">=</span>(<span class="dv">4</span>,), activation<span class="op">=</span><span class="st">'relu'</span>, random_state<span class="op">=</span><span class="dv">42</span>, max_iter<span class="op">=</span><span class="dv">5000</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>mlp_xor.fit(X_xor, y_xor)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>xx, yy <span class="op">=</span> np.meshgrid(np.linspace(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>, <span class="dv">100</span>), np.linspace(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>, <span class="dv">100</span>))</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> mlp_xor.predict(np.c_[xx.ravel(), yy.ravel()]).reshape(xx.shape)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].contourf(xx, yy, Z, alpha<span class="op">=</span><span class="fl">0.3</span>, cmap<span class="op">=</span><span class="st">'RdBu'</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].scatter(X_xor[y_xor<span class="op">==</span><span class="dv">0</span>, <span class="dv">0</span>], X_xor[y_xor<span class="op">==</span><span class="dv">0</span>, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">200</span>, c<span class="op">=</span><span class="st">'red'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">'ç±»åˆ« 0'</span>, edgecolors<span class="op">=</span><span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].scatter(X_xor[y_xor<span class="op">==</span><span class="dv">1</span>, <span class="dv">0</span>], X_xor[y_xor<span class="op">==</span><span class="dv">1</span>, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">200</span>, c<span class="op">=</span><span class="st">'blue'</span>, marker<span class="op">=</span><span class="st">'s'</span>, label<span class="op">=</span><span class="st">'ç±»åˆ« 1'</span>, edgecolors<span class="op">=</span><span class="st">'k'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">'xâ‚'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">'xâ‚‚'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">'XOR é—®é¢˜ï¼šå¤šå±‚ç½‘ç»œå¯ä»¥è§£å†³'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlim(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylim(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="å¤åˆ¶åˆ°å‰ªè´´æ¿" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_37997/3615795970.py:39: UserWarning:

Glyph 8321 (\N{SUBSCRIPT ONE}) missing from current font.

/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_37997/3615795970.py:39: UserWarning:

Glyph 8322 (\N{SUBSCRIPT TWO}) missing from current font.

/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:

Glyph 8322 (\N{SUBSCRIPT TWO}) missing from current font.

/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:

Glyph 8321 (\N{SUBSCRIPT ONE}) missing from current font.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="w6_neural_networks_files/figure-html/cell-4-output-2.png" width="1142" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="å¤šå±‚çš„å¨åŠ›å±‚æ¬¡ç‰¹å¾å­¦ä¹ " class="level3" data-number="12.3.2">
<h3 data-number="12.3.2" class="anchored" data-anchor-id="å¤šå±‚çš„å¨åŠ›å±‚æ¬¡ç‰¹å¾å­¦ä¹ "><span class="header-section-number">12.3.2</span> å¤šå±‚çš„å¨åŠ›ï¼šå±‚æ¬¡ç‰¹å¾å­¦ä¹ </h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    A[å›¾åƒè¯†åˆ«ä¾‹å­] --&gt; B[ç¬¬1å±‚&lt;br/&gt;æ£€æµ‹è¾¹ç¼˜]
    B --&gt; C[ç¬¬2å±‚&lt;br/&gt;æ£€æµ‹å½¢çŠ¶]
    C --&gt; D[ç¬¬3å±‚&lt;br/&gt;æ£€æµ‹ç‰©ä½“éƒ¨ä»¶]
    D --&gt; E[ç¬¬4å±‚&lt;br/&gt;è¯†åˆ«å®Œæ•´ç‰©ä½“]
    
    style B fill:#fff9c4
    style C fill:#c8e6c9
    style D fill:#bbdefb
    style E fill:#4caf50,color:#fff
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š</p>
<ul>
<li>æµ…å±‚ï¼šå­¦ä¹ ç®€å•ç‰¹å¾ï¼ˆè¾¹ç¼˜ã€çº¹ç†ï¼‰</li>
<li>æ·±å±‚ï¼šå­¦ä¹ å¤æ‚ç‰¹å¾ï¼ˆç»„åˆæ¨¡å¼ï¼‰</li>
<li>è¿™æ˜¯<strong>è‡ªåŠ¨ç‰¹å¾å·¥ç¨‹</strong>ï¼</li>
</ul>
<hr>
</section>
<section id="å±‚æ•°é€‰æ‹©å»ºè®®" class="level3" data-number="12.3.3">
<h3 data-number="12.3.3" class="anchored" data-anchor-id="å±‚æ•°é€‰æ‹©å»ºè®®"><span class="header-section-number">12.3.3</span> å±‚æ•°é€‰æ‹©å»ºè®®</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>æ•°æ®é‡</th>
<th>æ¨èå±‚æ•°</th>
<th>åŸå› </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt; 1ä¸‡</td>
<td>1-2 å±‚éšè—å±‚</td>
<td>æ•°æ®å°‘ï¼Œæ·±å±‚æ˜“è¿‡æ‹Ÿåˆ</td>
</tr>
<tr class="even">
<td>1ä¸‡-10ä¸‡</td>
<td>2-3 å±‚éšè—å±‚</td>
<td>ä¸­ç­‰å¤æ‚åº¦</td>
</tr>
<tr class="odd">
<td>&gt; 10ä¸‡</td>
<td>3-5 å±‚éšè—å±‚</td>
<td>å¤§æ•°æ®æ”¯æŒæ·±å±‚ç½‘ç»œ</td>
</tr>
<tr class="even">
<td>&gt; 100ä¸‡</td>
<td>5+ å±‚</td>
<td>éœ€è¦ç‰¹æ®ŠæŠ€å·§ï¼ˆä¸‹å‘¨è®²ï¼‰</td>
</tr>
</tbody>
</table>
<p><strong>ç»éªŒæ³•åˆ™</strong>ï¼š</p>
<ul>
<li>ä»ç®€å•å¼€å§‹ï¼ˆ2å±‚ï¼‰</li>
<li>å¦‚æœæ¬ æ‹Ÿåˆï¼Œå¢åŠ å±‚æ•°æˆ–ç¥ç»å…ƒæ•°</li>
<li>å¦‚æœè¿‡æ‹Ÿåˆï¼Œå‡å°‘å¤æ‚åº¦æˆ–ä½¿ç”¨æ­£åˆ™åŒ–ï¼ˆä¸‹å‘¨è®²ï¼‰</li>
</ul>
<hr>
</section>
</section>
</section>
<section id="ç¬¬å››éƒ¨åˆ†å‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> ç¬¬å››éƒ¨åˆ†ï¼šå‰å‘ä¼ æ’­ä¸åå‘ä¼ æ’­</h1>
<hr>
<section id="å‰å‘ä¼ æ’­forward-propagation" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="å‰å‘ä¼ æ’­forward-propagation"><span class="header-section-number">13.1</span> 4.1 å‰å‘ä¼ æ’­ï¼ˆForward Propagationï¼‰</h2>
<section id="ä»è¾“å…¥åˆ°è¾“å‡ºçš„ä¿¡æ¯æµ" class="level3" data-number="13.1.1">
<h3 data-number="13.1.1" class="anchored" data-anchor-id="ä»è¾“å…¥åˆ°è¾“å‡ºçš„ä¿¡æ¯æµ"><span class="header-section-number">13.1.1</span> ä»è¾“å…¥åˆ°è¾“å‡ºçš„ä¿¡æ¯æµ</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[è¾“å…¥&lt;br/&gt;x] --&gt; B[éšè—å±‚1&lt;br/&gt;hâ‚ = ReLU Wâ‚x+bâ‚]
    B --&gt; C[éšè—å±‚2&lt;br/&gt;hâ‚‚ = ReLU Wâ‚‚hâ‚+bâ‚‚]
    C --&gt; D[è¾“å‡º&lt;br/&gt;Å· = Ïƒ Wâ‚ƒhâ‚‚+bâ‚ƒ]
    
    style A fill:#fff9c4
    style B fill:#c8e6c9
    style C fill:#bbdefb
    style D fill:#4caf50,color:#fff
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>é€å±‚è®¡ç®—</strong>ï¼š</p>
<ol type="1">
<li>è¾“å…¥ï¼š<span class="math inline">\(x\)</span> = [æ€§åˆ«, å¹´é¾„, ç¥¨ä»·, â€¦]</li>
<li>éšè—å±‚1ï¼š<span class="math inline">\(h_1 = \text{ReLU}(W_1 x + b_1)\)</span></li>
<li>éšè—å±‚2ï¼š<span class="math inline">\(h_2 = \text{ReLU}(W_2 h_1 + b_2)\)</span></li>
<li>è¾“å‡ºï¼š<span class="math inline">\(\hat{y} = \sigma(W_3 h_2 + b_3)\)</span></li>
</ol>
<p><strong>ç»“æœ</strong>ï¼š<span class="math inline">\(\hat{y}\)</span> = 0.85ï¼ˆ85% å­˜æ´»æ¦‚ç‡ï¼‰</p>
<hr>
</section>
</section>
<section id="æŸå¤±å‡½æ•°loss-function" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="æŸå¤±å‡½æ•°loss-function"><span class="header-section-number">13.2</span> 4.2 æŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰</h2>
<section id="è¡¡é‡é¢„æµ‹è¯¯å·®" class="level3" data-number="13.2.1">
<h3 data-number="13.2.1" class="anchored" data-anchor-id="è¡¡é‡é¢„æµ‹è¯¯å·®"><span class="header-section-number">13.2.1</span> è¡¡é‡é¢„æµ‹è¯¯å·®</h3>
<p><strong>äºŒåˆ†ç±»ï¼šBinary Cross-Entropy</strong></p>
<p><span class="math display">\[
\text{Loss} = -\frac{1}{n}\sum_{i=1}^{n}\left[y_i \log(\hat{y}_i) + (1-y_i)\log(1-\hat{y}_i)\right]
\]</span></p>
<p><strong>ç›´è§‚ç†è§£</strong>ï¼š</p>
<ul>
<li>çœŸå®æ˜¯ 1ï¼Œé¢„æµ‹ 0.9 â†’ Loss å°ï¼ˆå¥½ï¼‰</li>
<li>çœŸå®æ˜¯ 1ï¼Œé¢„æµ‹ 0.1 â†’ Loss å¤§ï¼ˆå·®ï¼‰</li>
</ul>
<p><strong>ç±»æ¯”</strong>ï¼šLoss = è€ƒè¯•åˆ†æ•°ä¸æ»¡åˆ†çš„å·®è·</p>
<hr>
</section>
<section id="æŸå¤±å‡½æ•°å¯è§†åŒ–" class="level3" data-number="13.2.2">
<h3 data-number="13.2.2" class="anchored" data-anchor-id="æŸå¤±å‡½æ•°å¯è§†åŒ–"><span class="header-section-number">13.2.2</span> æŸå¤±å‡½æ•°å¯è§†åŒ–</h3>
<div id="b870f90f" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>ä»£ç </summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binary Cross-Entropy å¯è§†åŒ–</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>y_true_demo <span class="op">=</span> <span class="dv">1</span>  <span class="co"># çœŸå®æ ‡ç­¾</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>y_pred_range <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="fl">0.99</span>, <span class="dv">100</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>loss <span class="op">=</span> <span class="op">-</span>np.log(y_pred_range)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>plt.plot(y_pred_range, loss, linewidth<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">'#f44336'</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'é¢„æµ‹æ¦‚ç‡ Å·'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Binary Cross-Entropy Loss</span><span class="ch">\n</span><span class="st">ï¼ˆçœŸå®æ ‡ç­¾ y=1 æ—¶ï¼‰'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'å®Œç¾é¢„æµ‹'</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'éšæœºçŒœæµ‹'</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># æ ‡æ³¨</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="st">'Å· â†’ 1</span><span class="ch">\n</span><span class="st">Loss â†’ 0</span><span class="ch">\n</span><span class="st">(é¢„æµ‹å¯¹äº†)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#c8e6c9'</span>))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">0.1</span>, <span class="dv">4</span>, <span class="st">'Å· â†’ 0</span><span class="ch">\n</span><span class="st">Loss â†’ âˆ</span><span class="ch">\n</span><span class="st">(é¢„æµ‹é”™äº†)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'#ffccbc'</span>))</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="å¤åˆ¶åˆ°å‰ªè´´æ¿" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:

Glyph 375 (\N{LATIN SMALL LETTER Y WITH CIRCUMFLEX}) missing from current font.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="w6_neural_networks_files/figure-html/cell-5-output-2.png" width="798" height="547" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="åå‘ä¼ æ’­backpropagation" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="åå‘ä¼ æ’­backpropagation"><span class="header-section-number">13.3</span> 4.3 åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰</h2>
<section id="æ ¸å¿ƒæ€æƒ³ä¸è®²æ•°å­¦ç»†èŠ‚" class="level3" data-number="13.3.1">
<h3 data-number="13.3.1" class="anchored" data-anchor-id="æ ¸å¿ƒæ€æƒ³ä¸è®²æ•°å­¦ç»†èŠ‚"><span class="header-section-number">13.3.1</span> æ ¸å¿ƒæ€æƒ³ï¼ˆä¸è®²æ•°å­¦ç»†èŠ‚ï¼‰</h3>
<p><strong>é—®é¢˜</strong>ï¼šå¦‚ä½•è°ƒæ•´ W å’Œ b æ¥é™ä½ Lossï¼Ÿ</p>
<p><strong>æ–¹æ³•</strong>ï¼šè®¡ç®— Loss å¯¹æ¯ä¸ªå‚æ•°çš„â€è´¡çŒ®â€ï¼ˆæ¢¯åº¦ï¼‰</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph RL
    A[Loss] --&gt; B[âˆ‚Loss/âˆ‚Wâ‚ƒ&lt;br/&gt;âˆ‚Loss/âˆ‚bâ‚ƒ]
    B --&gt; C[âˆ‚Loss/âˆ‚Wâ‚‚&lt;br/&gt;âˆ‚Loss/âˆ‚bâ‚‚]
    C --&gt; D[âˆ‚Loss/âˆ‚Wâ‚&lt;br/&gt;âˆ‚Loss/âˆ‚bâ‚]
    
    style A fill:#f44336,color:#fff
    style B fill:#ffccbc
    style C fill:#fff9c4
    style D fill:#c8e6c9
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>æ›´æ–°è§„åˆ™</strong>ï¼š</p>
<p><span class="math display">\[
W_{\text{new}} = W_{\text{old}} - \eta \times \frac{\partial \text{Loss}}{\partial W}
\]</span></p>
<ul>
<li><span class="math inline">\(\eta\)</span>ï¼šå­¦ä¹ ç‡ï¼ˆæ­¥é•¿ï¼‰</li>
<li><span class="math inline">\(\frac{\partial \text{Loss}}{\partial W}\)</span>ï¼šæ¢¯åº¦ï¼ˆæ–¹å‘ï¼‰</li>
</ul>
<hr>
</section>
<section id="ç±»æ¯”ç™»å±±ä¸‹å¡" class="level3" data-number="13.3.2">
<h3 data-number="13.3.2" class="anchored" data-anchor-id="ç±»æ¯”ç™»å±±ä¸‹å¡"><span class="header-section-number">13.3.2</span> ç±»æ¯”ï¼šç™»å±±ä¸‹å¡</h3>
<div id="3f01e55e" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>ä»£ç </summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># æ¢¯åº¦ä¸‹é™å¯è§†åŒ–</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">100</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>  <span class="co"># ç®€å•çš„å‡¸å‡½æ•°</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, linewidth<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">'#2196f3'</span>, label<span class="op">=</span><span class="st">'Loss æ›²çº¿'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># æ¢¯åº¦ä¸‹é™è·¯å¾„</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>x_path <span class="op">=</span> [<span class="fl">1.8</span>, <span class="fl">1.2</span>, <span class="fl">0.7</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.0</span>]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>y_path <span class="op">=</span> [xi<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> xi <span class="kw">in</span> x_path]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>plt.plot(x_path, y_path, <span class="st">'ro-'</span>, markersize<span class="op">=</span><span class="dv">10</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'æ¢¯åº¦ä¸‹é™è·¯å¾„'</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>plt.scatter([<span class="dv">0</span>], [<span class="dv">1</span>], s<span class="op">=</span><span class="dv">300</span>, c<span class="op">=</span><span class="st">'green'</span>, marker<span class="op">=</span><span class="st">'*'</span>, zorder<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'æœ€ä¼˜ç‚¹'</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'å‚æ•° W'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'æ¢¯åº¦ä¸‹é™ï¼šæ²¿ç€å¡åº¦ä¸‹å±±'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'èµ·ç‚¹'</span>, xy<span class="op">=</span>(<span class="fl">1.8</span>, y_path[<span class="dv">0</span>]), xytext<span class="op">=</span>(<span class="dv">2</span>, <span class="fl">4.5</span>), </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, color<span class="op">=</span><span class="st">'red'</span>), fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>plt.annotate(<span class="st">'ç»ˆç‚¹ï¼ˆæœ€ä¼˜ï¼‰'</span>, xy<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>), xytext<span class="op">=</span>(<span class="fl">0.5</span>, <span class="dv">2</span>), </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>, color<span class="op">=</span><span class="st">'green'</span>), fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="å¤åˆ¶åˆ°å‰ªè´´æ¿" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="w6_neural_networks_files/figure-html/cell-6-output-1.png" width="956" height="527" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>ç±»æ¯”</strong>ï¼š</p>
<ul>
<li>åšèœå¤ªå’¸ï¼ˆLoss å¤§ï¼‰ â†’ ä¸‹æ¬¡å°‘æ”¾ç›ï¼ˆè°ƒæ•´å‚æ•°ï¼‰</li>
<li>é€šè¿‡ä¸æ–­å°è¯•ï¼Œæ‰¾åˆ°æœ€ä½³é…æ–¹ï¼ˆæœ€ä¼˜å‚æ•°ï¼‰</li>
</ul>
<hr>
</section>
</section>
<section id="ä¼˜åŒ–å™¨optimizer" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="ä¼˜åŒ–å™¨optimizer"><span class="header-section-number">13.4</span> 4.4 ä¼˜åŒ–å™¨ï¼ˆOptimizerï¼‰</h2>
<section id="sgd-vs-adam" class="level3" data-number="13.4.1">
<h3 data-number="13.4.1" class="anchored" data-anchor-id="sgd-vs-adam"><span class="header-section-number">13.4.1</span> SGD vs Adam</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>ä¼˜åŒ–å™¨</th>
<th>å…¨ç§°</th>
<th>ç‰¹ç‚¹</th>
<th>ä½•æ—¶ç”¨</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>SGD</strong></td>
<td>Stochastic Gradient Descent</td>
<td>æœ€åŸºç¡€<br>å­¦ä¹ ç‡å›ºå®š</td>
<td>ç®€å•é—®é¢˜<br>ç†è®ºç ”ç©¶</td>
</tr>
<tr class="even">
<td><strong>Adam</strong></td>
<td>Adaptive Moment Estimation</td>
<td>è‡ªé€‚åº”å­¦ä¹ ç‡<br>æ”¶æ•›å¿«</td>
<td><strong>å¤§å¤šæ•°æƒ…å†µé¦–é€‰</strong></td>
</tr>
</tbody>
</table>
<p><strong>å»ºè®®</strong>ï¼š</p>
<ul>
<li>åˆå­¦è€…ï¼š<strong>ç›´æ¥ç”¨ Adam</strong></li>
<li>æ•ˆæœä¸å¥½å†è¯• SGD</li>
</ul>
<hr>
</section>
</section>
</section>
<section id="ç¬¬äº”éƒ¨åˆ†mlp-vs-æ ‘æ¨¡å‹" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> ç¬¬äº”éƒ¨åˆ†ï¼šMLP vs æ ‘æ¨¡å‹</h1>
<hr>
<section id="ä½•æ—¶ç”¨æ ‘æ¨¡å‹ä½•æ—¶ç”¨-mlp" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="ä½•æ—¶ç”¨æ ‘æ¨¡å‹ä½•æ—¶ç”¨-mlp"><span class="header-section-number">14.1</span> ä½•æ—¶ç”¨æ ‘æ¨¡å‹ï¼Œä½•æ—¶ç”¨ MLPï¼Ÿ</h2>
<section id="å¯¹æ¯”è¡¨" class="level3" data-number="14.1.1">
<h3 data-number="14.1.1" class="anchored" data-anchor-id="å¯¹æ¯”è¡¨"><span class="header-section-number">14.1.1</span> å¯¹æ¯”è¡¨</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 42%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>ç»´åº¦</th>
<th>æ ‘æ¨¡å‹ï¼ˆRF/GBDTï¼‰</th>
<th>MLP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>é€‚ç”¨æ•°æ®</strong></td>
<td>è¡¨æ ¼æ•°æ®<br>ï¼ˆè¡Œåˆ—ç»“æ„ï¼‰</td>
<td>å›¾åƒã€æ–‡æœ¬ã€éŸ³é¢‘<br>ï¼ˆéç»“æ„åŒ–ï¼‰</td>
</tr>
<tr class="even">
<td><strong>ç‰¹å¾å·¥ç¨‹</strong></td>
<td>éœ€è¦äººå·¥å¤„ç†<br>ï¼ˆç¼–ç ã€ç¼ºå¤±å€¼ï¼‰</td>
<td>è‡ªåŠ¨å­¦ä¹ ç‰¹å¾</td>
</tr>
<tr class="odd">
<td><strong>è®­ç»ƒé€Ÿåº¦</strong></td>
<td>å¿«ï¼ˆåˆ†é’Ÿçº§ï¼‰</td>
<td>æ…¢ï¼ˆå°æ—¶çº§ï¼‰</td>
</tr>
<tr class="even">
<td><strong>è°ƒå‚éš¾åº¦</strong></td>
<td>ç®€å•ï¼ˆ3-5ä¸ªå‚æ•°ï¼‰</td>
<td>å¤æ‚ï¼ˆå±‚æ•°ã€ç¥ç»å…ƒæ•°ã€å­¦ä¹ ç‡â€¦ï¼‰</td>
</tr>
<tr class="odd">
<td><strong>å¯è§£é‡Šæ€§</strong></td>
<td>é«˜ï¼ˆç‰¹å¾é‡è¦æ€§ã€å¯è§†åŒ–ï¼‰</td>
<td>ä½ï¼ˆé»‘ç›’ï¼‰</td>
</tr>
<tr class="even">
<td><strong>æ ·æœ¬é‡è¦æ±‚</strong></td>
<td>å°æ•°æ®ä¹Ÿå¯ä»¥ï¼ˆ100+ï¼‰</td>
<td>éœ€è¦å¤§é‡æ•°æ®ï¼ˆ10000+ï¼‰</td>
</tr>
<tr class="odd">
<td><strong>è¿‡æ‹Ÿåˆ</strong></td>
<td>è¾ƒå®¹æ˜“æ§åˆ¶</td>
<td>å®¹æ˜“è¿‡æ‹Ÿåˆ</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="é‡‘èé¢†åŸŸå®é™…æƒ…å†µ" class="level3" data-number="14.1.2">
<h3 data-number="14.1.2" class="anchored" data-anchor-id="é‡‘èé¢†åŸŸå®é™…æƒ…å†µ"><span class="header-section-number">14.1.2</span> é‡‘èé¢†åŸŸå®é™…æƒ…å†µ</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>åœºæ™¯</th>
<th>æ•°æ®ç±»å‹</th>
<th>é¦–é€‰æ¨¡å‹</th>
<th>åŸå› </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>è´·æ¬¾è¿çº¦é¢„æµ‹</td>
<td>è¡¨æ ¼</td>
<td>GBDT</td>
<td>å¯è§£é‡Š</td>
</tr>
<tr class="even">
<td>æ¬ºè¯ˆæ£€æµ‹</td>
<td>è¡¨æ ¼</td>
<td>GBDT/RF</td>
<td>é€Ÿåº¦å¿«</td>
</tr>
<tr class="odd">
<td>å®¢æˆ·æµå¤±</td>
<td>è¡¨æ ¼</td>
<td>GBDT</td>
<td>å¯è§£é‡Š</td>
</tr>
<tr class="even">
<td>ç¥¨æ®è¯†åˆ«ï¼ˆOCRï¼‰</td>
<td>å›¾åƒ</td>
<td>CNN</td>
<td>å›¾åƒä¸“ç”¨</td>
</tr>
<tr class="odd">
<td>èˆ†æƒ…åˆ†æ</td>
<td>æ–‡æœ¬</td>
<td>BERT</td>
<td>æ–‡æœ¬ä¸“ç”¨</td>
</tr>
<tr class="even">
<td>è‚¡ç¥¨é¢„æµ‹</td>
<td>æ—¶é—´åºåˆ—</td>
<td>LSTM/Transformer</td>
<td>åºåˆ—ä¸“ç”¨</td>
</tr>
</tbody>
</table>
<p><strong>æ ¸å¿ƒç»“è®º</strong>ï¼š</p>
<ul>
<li><strong>è¡¨æ ¼æ•°æ®ï¼ˆ90%çš„é‡‘èä»»åŠ¡ï¼‰</strong> â†’ <strong>æ ‘æ¨¡å‹</strong></li>
<li><strong>å›¾åƒ/æ–‡æœ¬/éŸ³é¢‘</strong> â†’ æ·±åº¦å­¦ä¹ </li>
</ul>
<hr>
</section>
</section>
</section>
<section id="æ€»ç»“" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> æ€»ç»“</h1>
<hr>
<section id="æœ¬è®²çŸ¥è¯†å›é¡¾" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="æœ¬è®²çŸ¥è¯†å›é¡¾"><span class="header-section-number">15.1</span> æœ¬è®²çŸ¥è¯†å›é¡¾</h2>
<section id="ç¥ç»å…ƒæ¨¡å‹" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="ç¥ç»å…ƒæ¨¡å‹"><span class="header-section-number">15.1.1</span> ç¥ç»å…ƒæ¨¡å‹</h3>
<ul>
<li>ç”Ÿç‰©ç¥ç»å…ƒ â†’ äººå·¥ç¥ç»å…ƒ</li>
<li>åŠ æƒæ±‚å’Œ + æ¿€æ´»å‡½æ•°</li>
</ul>
</section>
<section id="æ¿€æ´»å‡½æ•°" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="æ¿€æ´»å‡½æ•°"><span class="header-section-number">15.1.2</span> æ¿€æ´»å‡½æ•°</h3>
<ul>
<li><strong>Sigmoid</strong>ï¼šè¾“å‡ºå±‚ï¼ˆäºŒåˆ†ç±»ï¼‰</li>
<li><strong>ReLU</strong>ï¼šéšè—å±‚é¦–é€‰</li>
<li><strong>Tanh</strong>ï¼šRNN ä¸“ç”¨</li>
</ul>
</section>
<section id="å¤šå±‚æ„ŸçŸ¥æœº" class="level3" data-number="15.1.3">
<h3 data-number="15.1.3" class="anchored" data-anchor-id="å¤šå±‚æ„ŸçŸ¥æœº"><span class="header-section-number">15.1.3</span> å¤šå±‚æ„ŸçŸ¥æœº</h3>
<ul>
<li>è¾“å…¥å±‚ â†’ éšè—å±‚ â†’ è¾“å‡ºå±‚</li>
<li>å‚æ•°ï¼šæƒé‡ W + åç½® b</li>
<li>å¤šå±‚ â†’ å­¦ä¹ å¤æ‚éçº¿æ€§æ¨¡å¼</li>
</ul>
<hr>
</section>
<section id="è®­ç»ƒè¿‡ç¨‹" class="level3" data-number="15.1.4">
<h3 data-number="15.1.4" class="anchored" data-anchor-id="è®­ç»ƒè¿‡ç¨‹"><span class="header-section-number">15.1.4</span> è®­ç»ƒè¿‡ç¨‹</h3>
<ul>
<li><strong>å‰å‘ä¼ æ’­</strong>ï¼šè¾“å…¥ â†’ è¾“å‡º</li>
<li><strong>æŸå¤±å‡½æ•°</strong>ï¼šè¡¡é‡è¯¯å·®</li>
<li><strong>åå‘ä¼ æ’­</strong>ï¼šè®¡ç®—æ¢¯åº¦</li>
<li><strong>ä¼˜åŒ–å™¨</strong>ï¼šæ›´æ–°å‚æ•°ï¼ˆæ¨è Adamï¼‰</li>
</ul>
</section>
<section id="mlp-vs-æ ‘æ¨¡å‹" class="level3" data-number="15.1.5">
<h3 data-number="15.1.5" class="anchored" data-anchor-id="mlp-vs-æ ‘æ¨¡å‹"><span class="header-section-number">15.1.5</span> MLP vs æ ‘æ¨¡å‹</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>åœºæ™¯</th>
<th>æ¨èæ¨¡å‹</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>è¡¨æ ¼æ•°æ®</td>
<td>æ ‘æ¨¡å‹</td>
</tr>
<tr class="even">
<td>å›¾åƒ</td>
<td>CNN</td>
</tr>
<tr class="odd">
<td>æ–‡æœ¬</td>
<td>Transformer</td>
</tr>
<tr class="even">
<td>éŸ³é¢‘</td>
<td>RNN/CNN</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="æ ¸å¿ƒè¦ç‚¹" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="æ ¸å¿ƒè¦ç‚¹"><span class="header-section-number">15.2</span> æ ¸å¿ƒè¦ç‚¹</h2>
<ol type="1">
<li><p><strong>æ·±åº¦å­¦ä¹ ä¸ç¥ç§˜</strong><br>
åŸºäºç®€å•çš„æ•°å­¦è¿ç®—ç´¯ç§¯</p></li>
<li><p><strong>æ¿€æ´»å‡½æ•°å¾ˆé‡è¦</strong><br>
éšè—å±‚ç”¨ ReLUï¼Œè¾“å‡ºå±‚çœ‹ä»»åŠ¡</p></li>
<li><p><strong>å½’ä¸€åŒ–æ˜¯å¿…é¡»çš„</strong><br>
ç¥ç»ç½‘ç»œå¯¹æ•°æ®å°ºåº¦æ•æ„Ÿ</p></li>
<li><p><strong>è¡¨æ ¼æ•°æ®æ ‘æ¨¡å‹æ›´å¥½</strong><br>
ä¸è¦è¿·ä¿¡æ·±åº¦å­¦ä¹ </p></li>
<li><p><strong>Keras å¾ˆç®€å•</strong><br>
Sequential API æ˜“ä¸Šæ‰‹</p></li>
</ol>
<hr>
</section>
</section>
<section id="qa" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Q&amp;A</h1>
<p><strong>Q1ï¼šäººå·¥ç¥ç»å…ƒæ˜¯å¦‚ä½•æ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»å…ƒçš„ï¼Ÿè¯·å†™å‡ºäººå·¥ç¥ç»å…ƒçš„åŸºæœ¬æ•°å­¦æ¨¡å‹ã€‚</strong></p>
<p><strong>Aï¼š</strong> äººå·¥ç¥ç»å…ƒæ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»å…ƒâ€œæ¥æ”¶ä¿¡å·-æ•´åˆå¤„ç†-æ¿€æ´»å‘ç«â€çš„è¿‡ç¨‹ã€‚</p>
<p>å®ƒçš„æ•°å­¦æ¨¡å‹æ˜¯ï¼š</p>
<ol type="1">
<li>åŠ æƒæ±‚å’Œï¼š <span class="math inline">\(z = \sum_{i=1}^{n} w_i x_i + b\)</span></li>
<li>æ¿€æ´»å‡½æ•°ï¼š <span class="math inline">\(y = f(z)\)</span> ï¼ˆå…¶ä¸­ <span class="math inline">\(x_i\)</span> æ˜¯è¾“å…¥ç‰¹å¾ï¼Œ<span class="math inline">\(w_i\)</span> æ˜¯æƒé‡ï¼Œ<span class="math inline">\(b\)</span> æ˜¯åç½®ï¼Œ<span class="math inline">\(f\)</span> æ˜¯æ¿€æ´»å‡½æ•°ï¼‰</li>
</ol>
<hr>
<p><strong>Q2ï¼šä¸ºä»€ä¹ˆç¥ç»ç½‘ç»œä¸­å¿…é¡»ä½¿ç”¨â€œéçº¿æ€§â€æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ ReLUï¼‰ï¼Ÿå¦‚æœåªç”¨çº¿æ€§æ¿€æ´»ï¼ˆæˆ–ä¸ç”¨æ¿€æ´»ï¼‰ï¼Œå¤šå±‚ç½‘ç»œä¼šé€€åŒ–æˆä»€ä¹ˆï¼Ÿ</strong></p>
<p><strong>Aï¼š</strong></p>
<ul>
<li>åŸå› ï¼šæ¿€æ´»å‡½æ•°çš„ä½œç”¨æ˜¯å¼•å…¥éçº¿æ€§ï¼Œä½¿å¾—ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ å’Œæ‹Ÿåˆå¤æ‚çš„éçº¿æ€§æ¨¡å¼ï¼ˆä¾‹å¦‚ XOR é—®é¢˜ï¼‰ã€‚</li>
<li>é€€åŒ–ï¼šå¦‚æœåªç”¨çº¿æ€§æ¿€æ´»ï¼Œå¤šå±‚çº¿æ€§å åŠ çš„ç»“æœä»ç„¶æ˜¯çº¿æ€§çš„ï¼ˆ<span class="math inline">\(W'x + b'\)</span>ï¼‰ã€‚è¿™ä¼šå¯¼è‡´æ•´ä¸ªæ·±åº¦ç¥ç»ç½‘ç»œé€€åŒ–æˆä¸€ä¸ªå•å±‚çš„çº¿æ€§æ¨¡å‹ï¼ˆå¦‚é€»è¾‘å›å½’ï¼‰ï¼Œå¤±å»æ·±åº¦å­¦ä¹ çš„æ„ä¹‰ã€‚</li>
</ul>
<hr>
<p><strong>Q3ï¼šä¸ºç¥ç»ç½‘ç»œçš„â€œéšè—å±‚â€å’Œâ€œäºŒåˆ†ç±»è¾“å‡ºå±‚â€é€‰æ‹©æ¿€æ´»å‡½æ•°æ—¶ï¼Œé¦–é€‰çš„æ¨èåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p><strong>Aï¼š</strong></p>
<ul>
<li>éšè—å±‚é¦–é€‰ï¼šReLUã€‚å› ä¸ºå®ƒè®¡ç®—å¿«ï¼Œå¹¶èƒ½æœ‰æ•ˆç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</li>
<li>äºŒåˆ†ç±»è¾“å‡ºå±‚é¦–é€‰ï¼šSigmoidã€‚å› ä¸ºå®ƒçš„è¾“å‡ºèŒƒå›´æ˜¯ (0, 1) ï¼Œå¯ä»¥å°†è¾“å‡ºç»“æœè§£é‡Šä¸ºæ¦‚ç‡ã€‚</li>
</ul>
<hr>
<p><strong>Q4ï¼šè¯·ç®€è¦æè¿°â€œå‰å‘ä¼ æ’­â€ï¼ˆForward Propagationï¼‰å’Œâ€œåå‘ä¼ æ’­â€ï¼ˆBackward Propagationï¼‰åœ¨ç¥ç»ç½‘ç»œè®­ç»ƒä¸­çš„è§’è‰²ã€‚</strong></p>
<p><strong>Aï¼š</strong></p>
<ul>
<li>å‰å‘ä¼ æ’­ï¼šæ˜¯æŒ‡æ•°æ®ä»è¾“å…¥å±‚å¼€å§‹ï¼Œé€å±‚è®¡ç®—ï¼Œç›´åˆ°åœ¨è¾“å‡ºå±‚å¾—åˆ°é¢„æµ‹å€¼ï¼ˆ<span class="math inline">\(\hat{y}\)</span>ï¼‰çš„è¿‡ç¨‹ã€‚</li>
<li>åå‘ä¼ æ’­ï¼šæ˜¯æŒ‡åœ¨å¾—åˆ°é¢„æµ‹å€¼å¹¶è®¡ç®—å‡º Lossï¼ˆè¯¯å·®ï¼‰åï¼Œä»è¾“å‡ºå±‚åå‘é€å±‚è®¡ç®— Loss å¯¹æ¯ä¸ªå‚æ•°ï¼ˆW å’Œ bï¼‰çš„æ¢¯åº¦ï¼ˆè´¡çŒ®åº¦ï¼‰çš„è¿‡ç¨‹ã€‚</li>
</ul>
<hr>
<p><strong>Q5ï¼šä¸ºä»€ä¹ˆ ReLU (<span class="math inline">\(\max(0, z)\)</span>) ä½œä¸ºéšè—å±‚æ¿€æ´»å‡½æ•°ï¼Œé€šå¸¸ä¼˜äº Sigmoidï¼ŸSigmoid ç”¨åœ¨éšè—å±‚æ—¶æœ‰ä»€ä¹ˆä¸»è¦ç¼ºé™·ï¼Ÿ</strong></p>
<p><strong>Aï¼š</strong> ReLU ä¹‹æ‰€ä»¥æ›´ä¼˜ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒè§£å†³äº† Sigmoid çš„ä¸€ä¸ªä¸»è¦ç¼ºé™·ï¼šæ¢¯åº¦æ¶ˆå¤±ï¼ˆGradient Vanishingï¼‰ã€‚</p>
<ul>
<li>Sigmoid çš„ç¼ºé™·ï¼šSigmoid å‡½æ•°åœ¨è¾“å…¥å€¼ï¼ˆzï¼‰å¾ˆå¤§æˆ–å¾ˆå°æ—¶ï¼Œå…¶æ›²çº¿éå¸¸å¹³å¦ï¼Œå¯¼è‡´æ¢¯åº¦ï¼ˆå¯¼æ•°ï¼‰æ¥è¿‘äº 0ã€‚åœ¨åå‘ä¼ æ’­æ—¶ï¼Œè¿™äº›æ¥è¿‘ 0 çš„æ¢¯åº¦é€å±‚ç›¸ä¹˜ï¼Œå¯¼è‡´æ·±å±‚ç½‘ç»œçš„æ¢¯åº¦å˜å¾—æå°ï¼Œä½¿å¾—å‚æ•°å‡ ä¹æ— æ³•æ›´æ–°ã€‚</li>
<li>ReLU çš„ä¼˜åŠ¿ï¼šå½“è¾“å…¥ <span class="math inline">\(z &gt; 0\)</span> æ—¶ï¼ŒReLU çš„æ¢¯åº¦æ’ä¸º 1ã€‚è¿™ä½¿å¾—æ¢¯åº¦åœ¨åå‘ä¼ æ’­æ—¶èƒ½å¤Ÿæ›´é¡ºç•…åœ°æµåŠ¨ï¼Œæå¤§åœ°ç¼“è§£äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œè®©ç½‘ç»œè®­ç»ƒå¾—æ›´å¿«ã€æ›´æ·±ã€‚</li>
</ul>
<hr>
<p><strong>Q6ï¼šå‡è®¾ä¸€ä¸ª MLP ç½‘ç»œç»“æ„ä¸º <code>Input(10) -&gt; Dense(32, ReLU) -&gt; Output(1, Sigmoid)</code>ã€‚è¯·é—®ä» Input å±‚åˆ° Dense(32) å±‚ï¼ˆç¬¬ä¸€ä¸ªéšè—å±‚ï¼‰æ€»å…±æœ‰å¤šå°‘ä¸ªå¯è®­ç»ƒå‚æ•°ï¼Ÿ</strong></p>
<p><strong>Aï¼š</strong> å¯è®­ç»ƒå‚æ•° = æƒé‡ï¼ˆWeightsï¼‰+ åç½®ï¼ˆBiasesï¼‰ã€‚</p>
<ol type="1">
<li>æƒé‡ (W)ï¼šæ¯ä¸ªè¾“å…¥ç¥ç»å…ƒéƒ½è¿æ¥åˆ°æ¯ä¸ªéšè—ç¥ç»å…ƒã€‚
<ul>
<li>è®¡ç®—ï¼š<code>è¾“å…¥ç»´åº¦ Ã— éšè—å±‚ç»´åº¦</code> = <span class="math inline">\(10 \times 32 = 320\)</span> ä¸ªã€‚</li>
</ul></li>
<li>åç½® (b)ï¼šéšè—å±‚ä¸­çš„æ¯ä¸ªç¥ç»å…ƒéƒ½æœ‰ 1 ä¸ªåç½®é¡¹ã€‚
<ul>
<li>è®¡ç®—ï¼š<code>éšè—å±‚ç»´åº¦</code> = <span class="math inline">\(32\)</span> ä¸ªã€‚</li>
</ul></li>
<li>æ€»è®¡ï¼š <span class="math inline">\(320 + 32 = \mathbf{352}\)</span> ä¸ªå¯è®­ç»ƒå‚æ•°ã€‚</li>
</ol>
<hr>
<p><strong>Q7ï¼šåœ¨åå‘ä¼ æ’­ä¸­ï¼Œæˆ‘ä»¬è®¡ç®—å‡º Loss å¯¹æƒé‡ W çš„æ¢¯åº¦ï¼ˆ<span class="math inline">\(\frac{\partial \text{Loss}}{\partial W}\)</span>ï¼‰åï¼Œæ˜¯å¦‚ä½•æ›´æ–°è¿™ä¸ªæƒé‡ W çš„ï¼Ÿï¼ˆè¯·å†™å‡ºæ›´æ–°è§„åˆ™ï¼‰ã€‚åœ¨è¿™ä¸ªè§„åˆ™ä¸­ï¼Œâ€œå­¦ä¹ ç‡ï¼ˆ<span class="math inline">\(\eta\)</span>ï¼‰â€æ‰®æ¼”äº†ä»€ä¹ˆè§’è‰²ï¼Ÿ</strong></p>
<p><strong>Aï¼š</strong></p>
<ul>
<li>æ›´æ–°è§„åˆ™ï¼š <span class="math inline">\(W_{\text{new}} = W_{\text{old}} - \eta \times \frac{\partial \text{Loss}}{\partial W}\)</span> ã€‚</li>
<li>å­¦ä¹ ç‡ï¼ˆ<span class="math inline">\(\eta\)</span>ï¼‰çš„è§’è‰²ï¼šå­¦ä¹ ç‡ï¼ˆLearning Rateï¼‰æ‰®æ¼”ç€â€œæ­¥é•¿â€çš„è§’è‰²ã€‚å®ƒæ§åˆ¶äº†æ¨¡å‹åœ¨â€œä¸‹å±±â€ï¼ˆé™ä½ Lossï¼‰æ—¶æ¯ä¸€æ­¥è¿ˆå¤šå¤§ã€‚
<ul>
<li><span class="math inline">\(\eta\)</span> å¤ªå¤§ï¼šå¯èƒ½ä¼šå¯¼è‡´â€œæ­¥å­è¿ˆå¤ªå¤§â€ï¼Œè¶Šè¿‡æœ€ä½ç‚¹ï¼Œå¯¼è‡´ Loss éœ‡è¡æˆ–å‘æ•£ã€‚</li>
<li><span class="math inline">\(\eta\)</span> å¤ªå°ï¼šä¼šå¯¼è‡´â€œå°ç¢æ­¥â€ä¸‹å±±ï¼Œè®­ç»ƒé€Ÿåº¦è¿‡æ…¢ï¼Œå¯èƒ½éœ€è¦å¾ˆä¹…æ‰èƒ½æ”¶æ•›ã€‚</li>
</ul></li>
</ul>
<hr>
<p><strong>Q8ï¼šå¯¹äºç»å¤§å¤šæ•°é‡‘èåœºæ™¯ä¸­çš„â€œè¡¨æ ¼æ•°æ®â€ï¼ˆåƒä¸€ä¸ª Excel è¡¨æ ¼ã€æ•°æ®åº“è¡¨ç±»å‹çš„æ•°æ®ï¼‰ï¼Œæ¨èé¦–é€‰å“ªä¸€ç±»æ¨¡å‹ï¼ˆæ ‘æ¨¡å‹è¿˜æ˜¯MLPï¼‰ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</strong></p>
<p><strong>Aï¼š</strong></p>
<ul>
<li>é¦–é€‰æ¨¡å‹ï¼šæ ‘æ¨¡å‹ï¼ˆç‰¹åˆ«æ˜¯ GBDTï¼‰ã€‚</li>
<li>åŸå› ï¼šå¯¹äºè¡¨æ ¼æ•°æ®ï¼Œæ ‘æ¨¡å‹é€šå¸¸è®­ç»ƒé€Ÿåº¦æ›´å¿«ã€è°ƒå‚æ›´ç®€å•ã€å¯è§£é‡Šæ€§æ›´å¼ºï¼Œå¹¶ä¸”åœ¨ä¸­å°è§„æ¨¡çš„æ•°æ®é›†ä¸Šï¼ˆé‡‘èé¢†åŸŸå¾ˆå¸¸è§ï¼‰è¡¨ç°å¾€å¾€ä¼˜äºéœ€è¦å¤§é‡æ•°æ®å’Œå¤æ‚è°ƒå‚çš„ MLPã€‚</li>
</ul>
<hr>
<p><strong>Q9ï¼šä¸€ä¸ªé‡‘èç§‘æŠ€å›¢é˜Ÿæƒ³ç”¨ MLPï¼ˆç¥ç»ç½‘ç»œï¼‰æ¥é¢„æµ‹å®¢æˆ·æµå¤±ï¼Œä»–ä»¬çš„æ•°æ®é›†åªæœ‰ 5000 è¡Œï¼ˆæ ·æœ¬ï¼‰å’Œ 20 ä¸ªç‰¹å¾ï¼ˆè¡¨æ ¼æ•°æ®ï¼‰ã€‚ä½ è®¤ä¸ºä»–ä»¬åº”è¯¥ä¼˜å…ˆä½¿ç”¨ MLP å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</strong></p>
<p><strong>Aï¼š</strong> ä¸åº”è¯¥ä¼˜å…ˆä½¿ç”¨ MLPã€‚</p>
<p>ç†ç”±å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ•°æ®é‡å¤ªå°ï¼šMLP é€šå¸¸éœ€è¦å¤§é‡æ•°æ®ï¼ˆä¾‹å¦‚ 1 ä¸‡æ¡ä»¥ä¸Šï¼‰æ‰èƒ½å­¦ä¹ å…¶æ•°åƒä¸ªå‚æ•°å¹¶é˜²æ­¢è¿‡æ‹Ÿåˆã€‚5000 è¡Œæ•°æ®å¯¹äº MLP æ¥è¯´å¤ªå°‘äº†ã€‚</li>
<li>æ ‘æ¨¡å‹æ›´ä¼˜ï¼šå¯¹äºè¿™ç§ä¸­å°å‹è¡¨æ ¼æ•°æ®ï¼Œæ ‘æ¨¡å‹ï¼ˆå¦‚ GBDT æˆ– éšæœºæ£®æ—ï¼‰é€šå¸¸è¡¨ç°æ›´å¥½ï¼Œå¹¶ä¸”è®­ç»ƒæ›´å¿«ã€å¯è§£é‡Šæ€§æ›´å¼ºï¼ˆè¿™å¯¹ä¸šåŠ¡å¾ˆé‡è¦ï¼‰ã€‚</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "å·²å¤åˆ¶");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "å·²å¤åˆ¶");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./w5_ensemble_learning.html" class="pagination-link" aria-label="ç¬¬äº”è®²ï¼šé›†æˆå­¦ä¹  - éšæœºæ£®æ—ä¸ GBDT">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">ç¬¬äº”è®²ï¼šé›†æˆå­¦ä¹  - éšæœºæ£®æ—ä¸ GBDT</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./project_list.html" class="pagination-link" aria-label="å…¥é—¨çº§ï¼ˆéš¾åº¦ç³»æ•° 0.9ï¼‰">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">å…¥é—¨çº§ï¼ˆéš¾åº¦ç³»æ•° 0.9ï¼‰</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>