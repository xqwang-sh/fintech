{
  "hash": "9f2dd417bc65f5278742b9dae8b278a7",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: 第六讲上机实践\n---\n\n\n\n\n本上机讲义覆盖以下内容：\n\n- 环境准备：安装/验证 TensorFlow/Keras\n- 数据准备：读取 Titanic 预处理后数据\n- 搭建 MLP：使用 Sequential API 构建多层感知机\n- 训练模型：设置超参数并训练\n- 可视化学习曲线：观察训练过程\n- 模型评估：计算准确率、AUC 等指标\n- 模型对比：MLP vs 随机森林\n\n**目标：** 掌握 Keras 构建、训练和评估神经网络的基本流程\n\n## 环境准备\n\n首先，我们需要导入必要的库并验证 TensorFlow/Keras 的安装。\n\n::: {#bf375b98 .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.metrics import roc_auc_score, accuracy_score, classification_report, roc_curve\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.datasets import fetch_openml\n\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\n\n# 设置中文字体\nplt.rcParams['font.sans-serif'] = ['SimHei']\nplt.rcParams['axes.unicode_minus'] = False\n%matplotlib inline\n\nprint(f\"TensorFlow 版本: {tf.__version__}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTensorFlow 版本: 2.15.0\n```\n:::\n:::\n\n\n## 数据准备\n\n我们使用 sklearn 的 `fetch_openml` 直接加载 Titanic 数据集，然后进行数据预处理：\n\n- 处理缺失值\n- 编码分类变量\n- 划分训练/测试集\n- **重要：** 对数值特征进行标准化（神经网络对特征尺度敏感）\n\n::: {#f5092009 .cell execution_count=2}\n``` {.python .cell-code}\n# 读取 W4 预处理后的数据\nX = pd.read_csv('titanic_data/features_processed.csv')\ny = pd.read_csv('titanic_data/labels_processed.csv')\n\n# 划分训练/测试集\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42, stratify=y)\n\n# 归一化（重要！神经网络对特征尺度敏感）\nscaler = StandardScaler()\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)\n\nprint(f\"训练集形状: {X_train.shape}\")\nprint(f\"测试集形状: {X_test.shape}\")\nprint(f\"特征数量: {X_train.shape[1]}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n训练集形状: (711, 8)\n测试集形状: (178, 8)\n特征数量: 8\n```\n:::\n:::\n\n\n## 搭建 MLP 模型\n\n使用 Keras 的 Sequential API 构建多层感知机：\n\n::: {#ff250777 .cell execution_count=3}\n``` {.python .cell-code}\n# 搭建 MLP 模型\nmodel = keras.Sequential([\n    # 输入层 + 第一个隐藏层\n    layers.Dense(64, activation='relu', input_shape=(X_train.shape[1],)),\n    # Dropout 层（防止过拟合）\n    layers.Dropout(0.2),\n    # 第二个隐藏层\n    layers.Dense(32, activation='relu'),\n    # Dropout 层\n    layers.Dropout(0.2),\n    # 输出层（二分类，使用 sigmoid 激活函数）\n    layers.Dense(1, activation='sigmoid')\n])\n\n# 查看模型结构\nmodel.summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModel: \"sequential\"\n_________________________________________________________________\n Layer (type)                Output Shape              Param #   \n=================================================================\n dense (Dense)               (None, 64)                576       \n                                                                 \n dropout (Dropout)           (None, 64)                0         \n                                                                 \n dense_1 (Dense)             (None, 32)                2080      \n                                                                 \n dropout_1 (Dropout)         (None, 32)                0         \n                                                                 \n dense_2 (Dense)             (None, 1)                 33        \n                                                                 \n=================================================================\nTotal params: 2689 (10.50 KB)\nTrainable params: 2689 (10.50 KB)\nNon-trainable params: 0 (0.00 Byte)\n_________________________________________________________________\n```\n:::\n:::\n\n\n## 编译模型\n\n设置损失函数、优化器和评估指标：\n\n::: {#064195ab .cell execution_count=4}\n``` {.python .cell-code}\n# 编译模型\nmodel.compile(\n    optimizer='adam',                    # 优化器\n    loss='binary_crossentropy',          # 二分类损失函数\n    metrics=['accuracy',                 # 准确率\n             tf.keras.metrics.AUC()]     # AUC 指标\n)\n```\n:::\n\n\n## 训练模型\n\n设置训练参数并开始训练：\n\n::: {#0676cfdd .cell execution_count=5}\n``` {.python .cell-code}\n# 训练参数\nepochs = 50          # 训练轮数\nbatch_size = 32      # 批次大小\n\n# 训练模型\nhistory = model.fit(\n    X_train, y_train,\n    epochs=epochs,\n    batch_size=batch_size,\n    validation_split=0.2,  # 从训练集中划分验证集\n    verbose=1\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEpoch 1/50\n\r 1/18 [>.............................] - ETA: 5s - loss: 0.7251 - accuracy: 0.5625 - auc: 0.4901\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 9ms/step - loss: 0.6073 - accuracy: 0.7183 - auc: 0.7448 - val_loss: 0.5487 - val_accuracy: 0.8042 - val_auc: 0.8440\nEpoch 2/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5534 - accuracy: 0.7500 - auc: 0.8512\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.5467 - accuracy: 0.7641 - auc: 0.7978 - val_loss: 0.4940 - val_accuracy: 0.8182 - val_auc: 0.8587\nEpoch 3/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4687 - accuracy: 0.7812 - auc: 0.8575\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4883 - accuracy: 0.7852 - auc: 0.8367 - val_loss: 0.4629 - val_accuracy: 0.8112 - val_auc: 0.8665\nEpoch 4/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4568 - accuracy: 0.7812 - auc: 0.8359\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4596 - accuracy: 0.7958 - auc: 0.8506 - val_loss: 0.4494 - val_accuracy: 0.8182 - val_auc: 0.8656\nEpoch 5/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5378 - accuracy: 0.7812 - auc: 0.7988\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4479 - accuracy: 0.7852 - auc: 0.8557 - val_loss: 0.4414 - val_accuracy: 0.8182 - val_auc: 0.8712\nEpoch 6/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4400 - accuracy: 0.8438 - auc: 0.8980\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4602 - accuracy: 0.7958 - auc: 0.8412 - val_loss: 0.4380 - val_accuracy: 0.8252 - val_auc: 0.8740\nEpoch 7/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4103 - accuracy: 0.8125 - auc: 0.8514\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4375 - accuracy: 0.8134 - auc: 0.8523 - val_loss: 0.4369 - val_accuracy: 0.8252 - val_auc: 0.8735\nEpoch 8/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5256 - accuracy: 0.8125 - auc: 0.7834\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4329 - accuracy: 0.8028 - auc: 0.8611 - val_loss: 0.4358 - val_accuracy: 0.8252 - val_auc: 0.8741\nEpoch 9/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3249 - accuracy: 0.9375 - auc: 0.9765\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4344 - accuracy: 0.8081 - auc: 0.8576 - val_loss: 0.4327 - val_accuracy: 0.8462 - val_auc: 0.8728\nEpoch 10/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4210 - accuracy: 0.8125 - auc: 0.8506\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4208 - accuracy: 0.8046 - auc: 0.8642 - val_loss: 0.4351 - val_accuracy: 0.8322 - val_auc: 0.8729\nEpoch 11/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5178 - accuracy: 0.7812 - auc: 0.8281\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4336 - accuracy: 0.8169 - auc: 0.8528 - val_loss: 0.4334 - val_accuracy: 0.8392 - val_auc: 0.8747\nEpoch 12/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4695 - accuracy: 0.6875 - auc: 0.8784\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4314 - accuracy: 0.8063 - auc: 0.8604 - val_loss: 0.4421 - val_accuracy: 0.8252 - val_auc: 0.8733\nEpoch 13/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5171 - accuracy: 0.7500 - auc: 0.7641\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4231 - accuracy: 0.8239 - auc: 0.8586 - val_loss: 0.4399 - val_accuracy: 0.8182 - val_auc: 0.8718\nEpoch 14/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3028 - accuracy: 0.9062 - auc: 0.9182\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4119 - accuracy: 0.8327 - auc: 0.8669 - val_loss: 0.4416 - val_accuracy: 0.8252 - val_auc: 0.8704\nEpoch 15/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3314 - accuracy: 0.8438 - auc: 0.9372\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4057 - accuracy: 0.8239 - auc: 0.8776 - val_loss: 0.4416 - val_accuracy: 0.8182 - val_auc: 0.8704\nEpoch 16/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3250 - accuracy: 0.8750 - auc: 0.9531\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4132 - accuracy: 0.8222 - auc: 0.8661 - val_loss: 0.4429 - val_accuracy: 0.8112 - val_auc: 0.8702\nEpoch 17/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3122 - accuracy: 0.9062 - auc: 0.8914\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3992 - accuracy: 0.8310 - auc: 0.8744 - val_loss: 0.4482 - val_accuracy: 0.8182 - val_auc: 0.8681\nEpoch 18/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.2924 - accuracy: 0.8750 - auc: 0.9155\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4051 - accuracy: 0.8310 - auc: 0.8690 - val_loss: 0.4563 - val_accuracy: 0.7902 - val_auc: 0.8650\nEpoch 19/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3950 - accuracy: 0.8125 - auc: 0.9062\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4051 - accuracy: 0.8151 - auc: 0.8708 - val_loss: 0.4553 - val_accuracy: 0.8252 - val_auc: 0.8654\nEpoch 20/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5096 - accuracy: 0.7500 - auc: 0.7841\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4110 - accuracy: 0.8275 - auc: 0.8660 - val_loss: 0.4508 - val_accuracy: 0.8252 - val_auc: 0.8653\nEpoch 21/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.2440 - accuracy: 0.9062 - auc: 0.9802\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3900 - accuracy: 0.8204 - auc: 0.8824 - val_loss: 0.4523 - val_accuracy: 0.8252 - val_auc: 0.8659\nEpoch 22/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5849 - accuracy: 0.7500 - auc: 0.8135\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4046 - accuracy: 0.8327 - auc: 0.8715 - val_loss: 0.4588 - val_accuracy: 0.8112 - val_auc: 0.8638\nEpoch 23/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4702 - accuracy: 0.8125 - auc: 0.7818\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4087 - accuracy: 0.8327 - auc: 0.8634 - val_loss: 0.4631 - val_accuracy: 0.8042 - val_auc: 0.8651\nEpoch 24/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.6717 - accuracy: 0.6875 - auc: 0.7078\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4002 - accuracy: 0.8292 - auc: 0.8773 - val_loss: 0.4622 - val_accuracy: 0.8182 - val_auc: 0.8681\nEpoch 25/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5258 - accuracy: 0.7188 - auc: 0.7891\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4028 - accuracy: 0.8310 - auc: 0.8726 - val_loss: 0.4577 - val_accuracy: 0.8182 - val_auc: 0.8695\nEpoch 26/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3648 - accuracy: 0.9062 - auc: 0.8750\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3966 - accuracy: 0.8363 - auc: 0.8726 - val_loss: 0.4603 - val_accuracy: 0.8112 - val_auc: 0.8689\nEpoch 27/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4777 - accuracy: 0.8125 - auc: 0.7754\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4078 - accuracy: 0.8292 - auc: 0.8664 - val_loss: 0.4605 - val_accuracy: 0.8182 - val_auc: 0.8714\nEpoch 28/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.2599 - accuracy: 0.9062 - auc: 0.9838\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3939 - accuracy: 0.8415 - auc: 0.8709 - val_loss: 0.4684 - val_accuracy: 0.8112 - val_auc: 0.8697\nEpoch 29/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5260 - accuracy: 0.7500 - auc: 0.7510\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3888 - accuracy: 0.8415 - auc: 0.8820 - val_loss: 0.4624 - val_accuracy: 0.8112 - val_auc: 0.8688\nEpoch 30/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4056 - accuracy: 0.8125 - auc: 0.8485\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.4029 - accuracy: 0.8204 - auc: 0.8734 - val_loss: 0.4644 - val_accuracy: 0.8042 - val_auc: 0.8682\nEpoch 31/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3384 - accuracy: 0.8750 - auc: 0.9275\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3898 - accuracy: 0.8363 - auc: 0.8766 - val_loss: 0.4584 - val_accuracy: 0.8112 - val_auc: 0.8709\nEpoch 32/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.2293 - accuracy: 0.9375 - auc: 0.9433\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3943 - accuracy: 0.8310 - auc: 0.8793 - val_loss: 0.4566 - val_accuracy: 0.8182 - val_auc: 0.8702\nEpoch 33/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3365 - accuracy: 0.9375 - auc: 0.7723\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3997 - accuracy: 0.8398 - auc: 0.8707 - val_loss: 0.4623 - val_accuracy: 0.8182 - val_auc: 0.8687\nEpoch 34/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3564 - accuracy: 0.8125 - auc: 0.9171\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3889 - accuracy: 0.8433 - auc: 0.8748 - val_loss: 0.4669 - val_accuracy: 0.8182 - val_auc: 0.8685\nEpoch 35/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3921 - accuracy: 0.8438 - auc: 0.8745\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3916 - accuracy: 0.8433 - auc: 0.8808 - val_loss: 0.4671 - val_accuracy: 0.8112 - val_auc: 0.8675\nEpoch 36/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4816 - accuracy: 0.7188 - auc: 0.7834\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3969 - accuracy: 0.8380 - auc: 0.8770 - val_loss: 0.4682 - val_accuracy: 0.8112 - val_auc: 0.8681\nEpoch 37/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4562 - accuracy: 0.7812 - auc: 0.8824\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3946 - accuracy: 0.8222 - auc: 0.8772 - val_loss: 0.4690 - val_accuracy: 0.8112 - val_auc: 0.8667\nEpoch 38/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4641 - accuracy: 0.8125 - auc: 0.7987\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3907 - accuracy: 0.8380 - auc: 0.8780 - val_loss: 0.4650 - val_accuracy: 0.8112 - val_auc: 0.8686\nEpoch 39/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.2903 - accuracy: 0.9375 - auc: 0.9125\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3817 - accuracy: 0.8380 - auc: 0.8809 - val_loss: 0.4726 - val_accuracy: 0.8042 - val_auc: 0.8678\nEpoch 40/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4123 - accuracy: 0.8438 - auc: 0.8357\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3770 - accuracy: 0.8398 - auc: 0.8927 - val_loss: 0.4700 - val_accuracy: 0.8042 - val_auc: 0.8684\nEpoch 41/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.6276 - accuracy: 0.6875 - auc: 0.7627\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3904 - accuracy: 0.8222 - auc: 0.8803 - val_loss: 0.4704 - val_accuracy: 0.8042 - val_auc: 0.8697\nEpoch 42/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3260 - accuracy: 0.8750 - auc: 0.9177\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3837 - accuracy: 0.8468 - auc: 0.8827 - val_loss: 0.4657 - val_accuracy: 0.8042 - val_auc: 0.8700\nEpoch 43/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5734 - accuracy: 0.7188 - auc: 0.7431\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3935 - accuracy: 0.8398 - auc: 0.8739 - val_loss: 0.4736 - val_accuracy: 0.8042 - val_auc: 0.8645\nEpoch 44/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.2433 - accuracy: 0.9062 - auc: 0.9804\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3990 - accuracy: 0.8327 - auc: 0.8725 - val_loss: 0.4672 - val_accuracy: 0.8182 - val_auc: 0.8693\nEpoch 45/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.5258 - accuracy: 0.7500 - auc: 0.7753\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3881 - accuracy: 0.8468 - auc: 0.8837 - val_loss: 0.4689 - val_accuracy: 0.8112 - val_auc: 0.8638\nEpoch 46/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4156 - accuracy: 0.8438 - auc: 0.8052\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3795 - accuracy: 0.8310 - auc: 0.8913 - val_loss: 0.4651 - val_accuracy: 0.8112 - val_auc: 0.8678\nEpoch 47/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3966 - accuracy: 0.8125 - auc: 0.8295\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3821 - accuracy: 0.8345 - auc: 0.8878 - val_loss: 0.4707 - val_accuracy: 0.8112 - val_auc: 0.8660\nEpoch 48/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.2980 - accuracy: 0.8438 - auc: 0.9667\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3791 - accuracy: 0.8504 - auc: 0.8818 - val_loss: 0.4760 - val_accuracy: 0.7972 - val_auc: 0.8657\nEpoch 49/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.3358 - accuracy: 0.8438 - auc: 0.9023\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3830 - accuracy: 0.8433 - auc: 0.8856 - val_loss: 0.4733 - val_accuracy: 0.8112 - val_auc: 0.8647\nEpoch 50/50\n\r 1/18 [>.............................] - ETA: 0s - loss: 0.4139 - accuracy: 0.8438 - auc: 0.9231\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/18 [==============================] - 0s 2ms/step - loss: 0.3788 - accuracy: 0.8415 - auc: 0.8891 - val_loss: 0.4721 - val_accuracy: 0.8042 - val_auc: 0.8652\n```\n:::\n:::\n\n\n## 可视化学习曲线\n\n观察训练过程中的损失和准确率变化：\n\n::: {#006444be .cell execution_count=6}\n``` {.python .cell-code}\n# 绘制学习曲线\nfig, axes = plt.subplots(1, 3, figsize=(18, 5))\n\n# 损失曲线\naxes[0].plot(history.history['loss'], label='训练损失', linewidth=2)\naxes[0].plot(history.history['val_loss'], label='验证损失', linewidth=2)\naxes[0].set_xlabel('训练轮数', fontsize=12)\naxes[0].set_ylabel('损失', fontsize=12)\naxes[0].set_title('损失曲线', fontsize=14)\naxes[0].legend()\naxes[0].grid(True, alpha=0.3)\n\n# 准确率曲线\naxes[1].plot(history.history['accuracy'], label='训练准确率', linewidth=2)\naxes[1].plot(history.history['val_accuracy'], label='验证准确率', linewidth=2)\naxes[1].set_xlabel('训练轮数', fontsize=12)\naxes[1].set_ylabel('准确率', fontsize=12)\naxes[1].set_title('准确率曲线', fontsize=14)\naxes[1].legend()\naxes[1].grid(True, alpha=0.3)\n\n# AUC 曲线\naxes[2].plot(history.history['auc'], label='训练 AUC', linewidth=2)\naxes[2].plot(history.history['val_auc'], label='验证 AUC', linewidth=2)\naxes[2].set_xlabel('训练轮数', fontsize=12)\naxes[2].set_ylabel('AUC', fontsize=12)\naxes[2].set_title('AUC 曲线', fontsize=14)\naxes[2].legend()\naxes[2].grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\nprint(\"学习曲线观察:\")\nprint(\"- 训练损失应该逐渐下降\")\nprint(\"- 验证损失开始上升可能表示过拟合\")\nprint(\"- 训练和验证指标差距过大也可能表示过拟合\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 35757 (\\N{CJK UNIFIED IDEOGRAPH-8BAD}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 32451 (\\N{CJK UNIFIED IDEOGRAPH-7EC3}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 36718 (\\N{CJK UNIFIED IDEOGRAPH-8F6E}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 25968 (\\N{CJK UNIFIED IDEOGRAPH-6570}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 25439 (\\N{CJK UNIFIED IDEOGRAPH-635F}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 22833 (\\N{CJK UNIFIED IDEOGRAPH-5931}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 26354 (\\N{CJK UNIFIED IDEOGRAPH-66F2}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 32447 (\\N{CJK UNIFIED IDEOGRAPH-7EBF}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 39564 (\\N{CJK UNIFIED IDEOGRAPH-9A8C}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 35777 (\\N{CJK UNIFIED IDEOGRAPH-8BC1}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 20934 (\\N{CJK UNIFIED IDEOGRAPH-51C6}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 30830 (\\N{CJK UNIFIED IDEOGRAPH-786E}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_6390/2172824844.py:31: UserWarning:\n\nGlyph 29575 (\\N{CJK UNIFIED IDEOGRAPH-7387}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 25439 (\\N{CJK UNIFIED IDEOGRAPH-635F}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 22833 (\\N{CJK UNIFIED IDEOGRAPH-5931}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26354 (\\N{CJK UNIFIED IDEOGRAPH-66F2}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 32447 (\\N{CJK UNIFIED IDEOGRAPH-7EBF}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 35757 (\\N{CJK UNIFIED IDEOGRAPH-8BAD}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 32451 (\\N{CJK UNIFIED IDEOGRAPH-7EC3}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 36718 (\\N{CJK UNIFIED IDEOGRAPH-8F6E}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 25968 (\\N{CJK UNIFIED IDEOGRAPH-6570}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 39564 (\\N{CJK UNIFIED IDEOGRAPH-9A8C}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 35777 (\\N{CJK UNIFIED IDEOGRAPH-8BC1}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 20934 (\\N{CJK UNIFIED IDEOGRAPH-51C6}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 30830 (\\N{CJK UNIFIED IDEOGRAPH-786E}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 29575 (\\N{CJK UNIFIED IDEOGRAPH-7387}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](w6_practice_files/figure-html/cell-7-output-2.png){width=1719 height=470}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n学习曲线观察:\n- 训练损失应该逐渐下降\n- 验证损失开始上升可能表示过拟合\n- 训练和验证指标差距过大也可能表示过拟合\n```\n:::\n:::\n\n\n## 模型评估\n\n在训练集和测试集上评估模型性能：\n\n- 准确率 (Accuracy)\n- AUC (Area Under ROC Curve)\n- 分类报告：精确率、召回率、F1 分数\n\n::: {#e85776ca .cell execution_count=7}\n``` {.python .cell-code}\n# 预测\ny_train_pred_prob = model.predict(X_train).flatten()\ny_test_pred_prob = model.predict(X_test).flatten()\n\ny_train_pred = (y_train_pred_prob > 0.5).astype(int)\ny_test_pred = (y_test_pred_prob > 0.5).astype(int)\n\n# 评估\nprint(\"=== 训练集 ===\")\nprint(f\"准确率: {accuracy_score(y_train, y_train_pred):.3f}\")\nprint(f\"AUC: {roc_auc_score(y_train, y_train_pred_prob):.3f}\")\n\nprint(\"\\n=== 测试集 ===\")\nprint(f\"准确率: {accuracy_score(y_test, y_test_pred):.3f}\")\nprint(f\"AUC: {roc_auc_score(y_test, y_test_pred_prob):.3f}\")\n\nprint(\"\\n分类报告:\")\nprint(classification_report(y_test, y_test_pred, target_names=['死亡', '存活']))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\r 1/23 [>.............................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r23/23 [==============================] - 0s 433us/step\n\r1/6 [====>.........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r6/6 [==============================] - 0s 523us/step\n=== 训练集 ===\n准确率: 0.845\nAUC: 0.893\n\n=== 测试集 ===\n准确率: 0.798\nAUC: 0.866\n\n分类报告:\n              precision    recall  f1-score   support\n\n          死亡       0.79      0.91      0.85       110\n          存活       0.81      0.62      0.70        68\n\n    accuracy                           0.80       178\n   macro avg       0.80      0.76      0.77       178\nweighted avg       0.80      0.80      0.79       178\n\n```\n:::\n:::\n\n\n## MLP vs 随机森林对比\n\n将 MLP 与传统的机器学习算法（随机森林）进行对比。\n\n**注意：** 随机森林不需要特征标准化，所以使用原始特征。\n\n::: {#c5de43ba .cell execution_count=8}\n``` {.python .cell-code}\n# 准备随机森林的数据（不需要标准化）\nX_train_orig, X_test_orig, _, _ = train_test_split(\n    X.values,\n    y.values,\n    test_size=0.2, random_state=42, stratify=y.values\n)\n\n# 训练随机森林\nrf = RandomForestClassifier(n_estimators=100, max_depth=5, random_state=42)\nrf.fit(X_train_orig, y_train)\ny_test_pred_rf = rf.predict_proba(X_test_orig)[:, 1]\n\n# 计算 AUC\nmlp_auc = roc_auc_score(y_test, y_test_pred_prob)\nrf_auc = roc_auc_score(y_test, y_test_pred_rf)\n\n# 对比表格\ncomparison = pd.DataFrame({\n    '模型': ['MLP', '随机森林'],\n    '测试集 AUC': [mlp_auc, rf_auc]\n})\n\nprint(\"模型对比:\")\nprint(comparison.to_string(index=False))\nprint(f\"\\nMLP 优势: {mlp_auc - rf_auc:+.3f} (AUC 差异)\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n模型对比:\n  模型  测试集 AUC\n MLP 0.865775\n随机森林 0.846791\n\nMLP 优势: +0.019 (AUC 差异)\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sklearn/base.py:1152: DataConversionWarning:\n\nA column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().\n\n```\n:::\n:::\n\n\n::: {#370aa87e .cell execution_count=9}\n``` {.python .cell-code}\n# ROC 曲线对比\nfpr_mlp, tpr_mlp, _ = roc_curve(y_test, y_test_pred_prob)\nfpr_rf, tpr_rf, _ = roc_curve(y_test, y_test_pred_rf)\n\nplt.figure(figsize=(10, 8))\nplt.plot(fpr_mlp, tpr_mlp, linewidth=3, label=f'MLP (AUC={mlp_auc:.3f})')\nplt.plot(fpr_rf, tpr_rf, linewidth=3, label=f'随机森林 (AUC={rf_auc:.3f})')\nplt.plot([0, 1], [0, 1], 'k--', linewidth=2, label='随机猜测')\nplt.xlabel('FPR (False Positive Rate)', fontsize=12)\nplt.ylabel('TPR (True Positive Rate)', fontsize=12)\nplt.title('MLP vs 随机森林 - ROC 曲线对比', fontsize=14)\nplt.legend(fontsize=11)\nplt.grid(True, alpha=0.3)\nplt.show()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 38543 (\\N{CJK UNIFIED IDEOGRAPH-968F}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26426 (\\N{CJK UNIFIED IDEOGRAPH-673A}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26862 (\\N{CJK UNIFIED IDEOGRAPH-68EE}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26519 (\\N{CJK UNIFIED IDEOGRAPH-6797}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26354 (\\N{CJK UNIFIED IDEOGRAPH-66F2}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 32447 (\\N{CJK UNIFIED IDEOGRAPH-7EBF}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 23545 (\\N{CJK UNIFIED IDEOGRAPH-5BF9}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 27604 (\\N{CJK UNIFIED IDEOGRAPH-6BD4}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 29468 (\\N{CJK UNIFIED IDEOGRAPH-731C}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 27979 (\\N{CJK UNIFIED IDEOGRAPH-6D4B}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](w6_practice_files/figure-html/cell-10-output-2.png){width=815 height=676}\n:::\n:::\n\n\n## 小结\n\n**结论：** 在 Titanic 数据集上，随机森林通常表现略好于或持平于基础 MLP。这是正常的，因为：\n\n1. **数据集较小**：神经网络需要大量数据才能充分发挥优势\n2. **特征工程**：随机森林对特征预处理要求较低\n3. **模型复杂度**：我们使用的 MLP 结构相对简单\n\n**MLP 的优势将在更大规模的数据集和更复杂的任务中体现。**\n\n**练习任务：**\n\n- 尝试调整 MLP 的隐藏层神经元数量\n- 尝试不同的激活函数\n- 观察过拟合现象（增加 epochs）\n- 尝试其他数据集（如 MNIST 手写数字识别）\n\n**神经网络的关键概念：**\n\n- **层（Layers）**：神经网络的基本构建块\n- **激活函数（Activation）**：为网络引入非线性\n- **损失函数（Loss）**：衡量预测与真实值的差距\n- **优化器（Optimizer）**：更新网络参数的算法\n- **批次（Batch）**：每次更新使用的样本数量\n- **轮次（Epoch）**：完整遍历训练集的次数\n\n**超参数调优建议：**\n\n- **网络结构**：尝试不同的隐藏层数量和神经元数量\n- **学习率**：太大会震荡，太小会收敛慢\n- **批次大小**：通常 32-128 之间\n- **正则化**：Dropout、L1/L2 正则化防止过拟合\n- **早停（Early Stopping）**：监控验证损失，防止过拟合\n\n",
    "supporting": [
      "w6_practice_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}