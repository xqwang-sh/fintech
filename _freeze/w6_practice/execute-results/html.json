{
  "hash": "4609f3183b34f678483aae4e26baf5e5",
  "result": {
    "engine": "jupyter",
    "markdown": "# W6 上机：Keras MLP 实战\n\n本上机讲义覆盖 W6 上机大纲：\n\n- 环境准备：安装/验证 TensorFlow/Keras\n- 数据准备：加载 Titanic 数据集，预处理和标准化\n- 搭建 MLP：使用 Sequential API 构建多层感知机\n- 训练模型：设置超参数并训练\n- 可视化学习曲线：观察训练过程\n- 模型评估：计算准确率、AUC 等指标\n- 模型对比：MLP vs 随机森林\n\n**目标：** 掌握 Keras 构建、训练和评估神经网络的基本流程\n\n## 6.1 环境准备\n\n首先，我们需要导入必要的库并验证 TensorFlow/Keras 的安装。\n\n::: {#d41e1ef3 .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.metrics import roc_auc_score, accuracy_score, classification_report, roc_curve\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.datasets import fetch_openml\n\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\n\n# 设置中文字体\nplt.rcParams['font.sans-serif'] = ['SimHei']\nplt.rcParams['axes.unicode_minus'] = False\n%matplotlib inline\n\nprint(f\"TensorFlow 版本: {tf.__version__}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTensorFlow 版本: 2.15.0\n```\n:::\n:::\n\n\n## 6.2 数据准备\n\n我们使用 sklearn 的 `fetch_openml` 直接加载 Titanic 数据集，然后进行数据预处理：\n\n- 处理缺失值\n- 编码分类变量\n- 划分训练/测试集\n- **重要：** 对数值特征进行标准化（神经网络对特征尺度敏感）\n\n::: {#a0838279 .cell execution_count=2}\n``` {.python .cell-code}\n# 加载 Titanic 数据集\ntitanic = fetch_openml('titanic', version=1, as_frame=True, parser='auto')\ndf = titanic.frame\n\n# 选择相关特征\ndf_clean = df[['pclass', 'sex', 'age', 'sibsp', 'parch', 'fare', 'embarked', 'survived']].copy()\ndf_clean.columns = ['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare', 'Embarked', 'Survived']\n\n# 数据预处理：处理缺失值\ndf_clean['Age'].fillna(df_clean['Age'].median(), inplace=True)\ndf_clean['Fare'].fillna(df_clean['Fare'].median(), inplace=True)\ndf_clean['Embarked'].fillna(df_clean['Embarked'].mode()[0], inplace=True)\n\n# 编码分类变量\nle_sex = LabelEncoder()\ndf_clean['Sex'] = le_sex.fit_transform(df_clean['Sex'])\ndf_clean = pd.get_dummies(df_clean, columns=['Embarked'], drop_first=True)\n\n# 分离特征和标签\nX = df_clean.drop('Survived', axis=1).values\ny = df_clean['Survived'].astype(int).values\n\n# 划分训练/测试集\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42, stratify=y)\n\n# 归一化（重要！神经网络对特征尺度敏感）\nscaler = StandardScaler()\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)\n\nprint(f\"训练集形状: {X_train.shape}\")\nprint(f\"测试集形状: {X_test.shape}\")\nprint(f\"特征数量: {X_train.shape[1]}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n训练集形状: (1047, 8)\n测试集形状: (262, 8)\n特征数量: 8\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/1578517670.py:10: FutureWarning:\n\nA value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.\nThe behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.\n\nFor example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.\n\n\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/1578517670.py:11: FutureWarning:\n\nA value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.\nThe behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.\n\nFor example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.\n\n\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/1578517670.py:12: FutureWarning:\n\nA value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.\nThe behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.\n\nFor example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.\n\n\n\n```\n:::\n:::\n\n\n## 6.3 搭建 MLP 模型\n\n使用 Keras 的 Sequential API 构建多层感知机：\n\n::: {#d94feb69 .cell execution_count=3}\n``` {.python .cell-code}\n# 搭建 MLP 模型\nmodel = keras.Sequential([\n    # 输入层 + 第一个隐藏层\n    layers.Dense(64, activation='relu', input_shape=(X_train.shape[1],)),\n    # Dropout 层（防止过拟合）\n    layers.Dropout(0.2),\n    # 第二个隐藏层\n    layers.Dense(32, activation='relu'),\n    # Dropout 层\n    layers.Dropout(0.2),\n    # 输出层（二分类，使用 sigmoid 激活函数）\n    layers.Dense(1, activation='sigmoid')\n])\n\n# 查看模型结构\nmodel.summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nModel: \"sequential\"\n_________________________________________________________________\n Layer (type)                Output Shape              Param #   \n=================================================================\n dense (Dense)               (None, 64)                576       \n                                                                 \n dropout (Dropout)           (None, 64)                0         \n                                                                 \n dense_1 (Dense)             (None, 32)                2080      \n                                                                 \n dropout_1 (Dropout)         (None, 32)                0         \n                                                                 \n dense_2 (Dense)             (None, 1)                 33        \n                                                                 \n=================================================================\nTotal params: 2689 (10.50 KB)\nTrainable params: 2689 (10.50 KB)\nNon-trainable params: 0 (0.00 Byte)\n_________________________________________________________________\n```\n:::\n:::\n\n\n## 6.4 编译模型\n\n设置损失函数、优化器和评估指标：\n\n::: {#75ae2a2d .cell execution_count=4}\n``` {.python .cell-code}\n# 编译模型\nmodel.compile(\n    optimizer='adam',                    # 优化器\n    loss='binary_crossentropy',          # 二分类损失函数\n    metrics=['accuracy',                 # 准确率\n             tf.keras.metrics.AUC()]     # AUC 指标\n)\n```\n:::\n\n\n## 6.5 训练模型\n\n设置训练参数并开始训练：\n\n::: {#b4371d24 .cell execution_count=5}\n``` {.python .cell-code}\n# 训练参数\nepochs = 50          # 训练轮数\nbatch_size = 32      # 批次大小\n\n# 训练模型\nhistory = model.fit(\n    X_train, y_train,\n    epochs=epochs,\n    batch_size=batch_size,\n    validation_split=0.2,  # 从训练集中划分验证集\n    verbose=1\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEpoch 1/50\n\r 1/27 [>.............................] - ETA: 4s - loss: 0.7432 - accuracy: 0.4375 - auc: 0.3965\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 4ms/step - loss: 0.6521 - accuracy: 0.6476 - auc: 0.6625 - val_loss: 0.5662 - val_accuracy: 0.7429 - val_auc: 0.7861\nEpoch 2/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.6170 - accuracy: 0.5938 - auc: 0.7000\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 857us/step - loss: 0.5487 - accuracy: 0.7599 - auc: 0.7998 - val_loss: 0.5169 - val_accuracy: 0.7667 - val_auc: 0.8010\nEpoch 3/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.5208 - accuracy: 0.7500 - auc: 0.8312\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 798us/step - loss: 0.5031 - accuracy: 0.7790 - auc: 0.8294 - val_loss: 0.4963 - val_accuracy: 0.7810 - val_auc: 0.8069\nEpoch 4/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4003 - accuracy: 0.8750 - auc: 0.8958\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 782us/step - loss: 0.4862 - accuracy: 0.7861 - auc: 0.8303 - val_loss: 0.4913 - val_accuracy: 0.7667 - val_auc: 0.8059\nEpoch 5/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.5835 - accuracy: 0.7188 - auc: 0.7559\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 786us/step - loss: 0.4917 - accuracy: 0.7730 - auc: 0.8234 - val_loss: 0.4892 - val_accuracy: 0.7762 - val_auc: 0.8042\nEpoch 6/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3792 - accuracy: 0.9062 - auc: 0.9157\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 768us/step - loss: 0.4665 - accuracy: 0.7790 - auc: 0.8432 - val_loss: 0.4936 - val_accuracy: 0.7619 - val_auc: 0.8012\nEpoch 7/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3818 - accuracy: 0.8750 - auc: 0.9167\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 775us/step - loss: 0.4707 - accuracy: 0.7873 - auc: 0.8368 - val_loss: 0.4936 - val_accuracy: 0.7667 - val_auc: 0.7984\nEpoch 8/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.5594 - accuracy: 0.7188 - auc: 0.8016\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 773us/step - loss: 0.4591 - accuracy: 0.7885 - auc: 0.8441 - val_loss: 0.4957 - val_accuracy: 0.7714 - val_auc: 0.7986\nEpoch 9/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4474 - accuracy: 0.7188 - auc: 0.8766\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 770us/step - loss: 0.4418 - accuracy: 0.7957 - auc: 0.8571 - val_loss: 0.5036 - val_accuracy: 0.7619 - val_auc: 0.7911\nEpoch 10/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3945 - accuracy: 0.8125 - auc: 0.8947\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 781us/step - loss: 0.4481 - accuracy: 0.7981 - auc: 0.8468 - val_loss: 0.4959 - val_accuracy: 0.7762 - val_auc: 0.7964\nEpoch 11/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3706 - accuracy: 0.8750 - auc: 0.8887\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 789us/step - loss: 0.4369 - accuracy: 0.7993 - auc: 0.8617 - val_loss: 0.5018 - val_accuracy: 0.7762 - val_auc: 0.7914\nEpoch 12/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.5715 - accuracy: 0.6875 - auc: 0.7753\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 771us/step - loss: 0.4347 - accuracy: 0.8053 - auc: 0.8582 - val_loss: 0.5036 - val_accuracy: 0.7762 - val_auc: 0.7935\nEpoch 13/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3497 - accuracy: 0.9062 - auc: 0.9134\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 779us/step - loss: 0.4313 - accuracy: 0.8172 - auc: 0.8650 - val_loss: 0.5029 - val_accuracy: 0.7714 - val_auc: 0.7937\nEpoch 14/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4475 - accuracy: 0.7500 - auc: 0.8406\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 765us/step - loss: 0.4263 - accuracy: 0.7957 - auc: 0.8668 - val_loss: 0.5051 - val_accuracy: 0.7619 - val_auc: 0.7942\nEpoch 15/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4311 - accuracy: 0.7500 - auc: 0.8909\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 774us/step - loss: 0.4419 - accuracy: 0.8029 - auc: 0.8560 - val_loss: 0.5066 - val_accuracy: 0.7667 - val_auc: 0.7923\nEpoch 16/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4042 - accuracy: 0.8125 - auc: 0.8636\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 776us/step - loss: 0.4467 - accuracy: 0.7981 - auc: 0.8524 - val_loss: 0.5080 - val_accuracy: 0.7810 - val_auc: 0.7922\nEpoch 17/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4534 - accuracy: 0.7500 - auc: 0.8406\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 758us/step - loss: 0.4435 - accuracy: 0.8005 - auc: 0.8509 - val_loss: 0.5068 - val_accuracy: 0.7667 - val_auc: 0.7939\nEpoch 18/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4941 - accuracy: 0.8438 - auc: 0.7895\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 773us/step - loss: 0.4298 - accuracy: 0.7945 - auc: 0.8658 - val_loss: 0.5097 - val_accuracy: 0.7714 - val_auc: 0.7944\nEpoch 19/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.5516 - accuracy: 0.7500 - auc: 0.7988\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 760us/step - loss: 0.4363 - accuracy: 0.8088 - auc: 0.8595 - val_loss: 0.5063 - val_accuracy: 0.7667 - val_auc: 0.7976\nEpoch 20/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4379 - accuracy: 0.8438 - auc: 0.7404\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 770us/step - loss: 0.4222 - accuracy: 0.8124 - auc: 0.8692 - val_loss: 0.5048 - val_accuracy: 0.7714 - val_auc: 0.7964\nEpoch 21/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.2775 - accuracy: 0.9375 - auc: 0.9662\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 773us/step - loss: 0.4257 - accuracy: 0.8029 - auc: 0.8686 - val_loss: 0.5035 - val_accuracy: 0.7714 - val_auc: 0.7979\nEpoch 22/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3028 - accuracy: 0.9062 - auc: 0.9568\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 788us/step - loss: 0.4226 - accuracy: 0.8088 - auc: 0.8665 - val_loss: 0.5044 - val_accuracy: 0.7857 - val_auc: 0.7978\nEpoch 23/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3619 - accuracy: 0.8438 - auc: 0.8961\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 771us/step - loss: 0.4165 - accuracy: 0.8100 - auc: 0.8681 - val_loss: 0.5065 - val_accuracy: 0.7810 - val_auc: 0.7973\nEpoch 24/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.5419 - accuracy: 0.7188 - auc: 0.7205\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 769us/step - loss: 0.4244 - accuracy: 0.8112 - auc: 0.8704 - val_loss: 0.5072 - val_accuracy: 0.7762 - val_auc: 0.7951\nEpoch 25/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4701 - accuracy: 0.7812 - auc: 0.8867\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 762us/step - loss: 0.4215 - accuracy: 0.8184 - auc: 0.8700 - val_loss: 0.5038 - val_accuracy: 0.7810 - val_auc: 0.7972\nEpoch 26/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4029 - accuracy: 0.8438 - auc: 0.8720\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 758us/step - loss: 0.4247 - accuracy: 0.8160 - auc: 0.8703 - val_loss: 0.5075 - val_accuracy: 0.7762 - val_auc: 0.7949\nEpoch 27/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4680 - accuracy: 0.7500 - auc: 0.8644\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 760us/step - loss: 0.4192 - accuracy: 0.8136 - auc: 0.8696 - val_loss: 0.5040 - val_accuracy: 0.7810 - val_auc: 0.7990\nEpoch 28/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3969 - accuracy: 0.8125 - auc: 0.8718\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 768us/step - loss: 0.4345 - accuracy: 0.8076 - auc: 0.8675 - val_loss: 0.5073 - val_accuracy: 0.7810 - val_auc: 0.7962\nEpoch 29/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4436 - accuracy: 0.7812 - auc: 0.8164\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 758us/step - loss: 0.4245 - accuracy: 0.8112 - auc: 0.8684 - val_loss: 0.5082 - val_accuracy: 0.7762 - val_auc: 0.7956\nEpoch 30/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.2955 - accuracy: 0.9062 - auc: 0.9688\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 777us/step - loss: 0.4159 - accuracy: 0.8148 - auc: 0.8734 - val_loss: 0.5091 - val_accuracy: 0.7810 - val_auc: 0.7949\nEpoch 31/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4779 - accuracy: 0.8438 - auc: 0.7705\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 838us/step - loss: 0.4258 - accuracy: 0.8184 - auc: 0.8709 - val_loss: 0.5090 - val_accuracy: 0.7810 - val_auc: 0.7960\nEpoch 32/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3458 - accuracy: 0.8750 - auc: 0.9146\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 800us/step - loss: 0.4067 - accuracy: 0.8065 - auc: 0.8810 - val_loss: 0.5118 - val_accuracy: 0.7810 - val_auc: 0.7948\nEpoch 33/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.2071 - accuracy: 0.9688 - auc: 0.9960\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 785us/step - loss: 0.4015 - accuracy: 0.8220 - auc: 0.8848 - val_loss: 0.5137 - val_accuracy: 0.7762 - val_auc: 0.7932\nEpoch 34/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3283 - accuracy: 0.9062 - auc: 0.9325\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 771us/step - loss: 0.4231 - accuracy: 0.8100 - auc: 0.8711 - val_loss: 0.5084 - val_accuracy: 0.7810 - val_auc: 0.7942\nEpoch 35/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4881 - accuracy: 0.8750 - auc: 0.8421\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 776us/step - loss: 0.4142 - accuracy: 0.8088 - auc: 0.8767 - val_loss: 0.5165 - val_accuracy: 0.7810 - val_auc: 0.7936\nEpoch 36/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.5313 - accuracy: 0.7500 - auc: 0.8198\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 758us/step - loss: 0.4066 - accuracy: 0.8172 - auc: 0.8820 - val_loss: 0.5189 - val_accuracy: 0.7810 - val_auc: 0.7927\nEpoch 37/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4071 - accuracy: 0.8125 - auc: 0.8500\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 769us/step - loss: 0.4138 - accuracy: 0.8184 - auc: 0.8714 - val_loss: 0.5130 - val_accuracy: 0.7714 - val_auc: 0.7946\nEpoch 38/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.2906 - accuracy: 0.8750 - auc: 0.9437\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 751us/step - loss: 0.4139 - accuracy: 0.8100 - auc: 0.8734 - val_loss: 0.5132 - val_accuracy: 0.7714 - val_auc: 0.7952\nEpoch 39/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3857 - accuracy: 0.8438 - auc: 0.8853\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 771us/step - loss: 0.4092 - accuracy: 0.8136 - auc: 0.8747 - val_loss: 0.5152 - val_accuracy: 0.7810 - val_auc: 0.7937\nEpoch 40/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4638 - accuracy: 0.8125 - auc: 0.8313\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 771us/step - loss: 0.4207 - accuracy: 0.8088 - auc: 0.8742 - val_loss: 0.5166 - val_accuracy: 0.7762 - val_auc: 0.7922\nEpoch 41/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.2654 - accuracy: 0.9062 - auc: 0.9437\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 783us/step - loss: 0.4078 - accuracy: 0.8220 - auc: 0.8811 - val_loss: 0.5201 - val_accuracy: 0.7857 - val_auc: 0.7927\nEpoch 42/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.5443 - accuracy: 0.6875 - auc: 0.8706\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 796us/step - loss: 0.4066 - accuracy: 0.8148 - auc: 0.8765 - val_loss: 0.5206 - val_accuracy: 0.7762 - val_auc: 0.7906\nEpoch 43/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.2557 - accuracy: 0.9062 - auc: 0.9697\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 783us/step - loss: 0.4061 - accuracy: 0.8208 - auc: 0.8829 - val_loss: 0.5196 - val_accuracy: 0.7762 - val_auc: 0.7919\nEpoch 44/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3885 - accuracy: 0.7812 - auc: 0.9069\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 798us/step - loss: 0.4154 - accuracy: 0.8148 - auc: 0.8739 - val_loss: 0.5281 - val_accuracy: 0.7762 - val_auc: 0.7872\nEpoch 45/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.6133 - accuracy: 0.6875 - auc: 0.7348\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 770us/step - loss: 0.4134 - accuracy: 0.8053 - auc: 0.8754 - val_loss: 0.5203 - val_accuracy: 0.7762 - val_auc: 0.7893\nEpoch 46/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4815 - accuracy: 0.7500 - auc: 0.8138\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 766us/step - loss: 0.4204 - accuracy: 0.8088 - auc: 0.8767 - val_loss: 0.5224 - val_accuracy: 0.7857 - val_auc: 0.7901\nEpoch 47/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4844 - accuracy: 0.8125 - auc: 0.8273\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 760us/step - loss: 0.4141 - accuracy: 0.8172 - auc: 0.8771 - val_loss: 0.5217 - val_accuracy: 0.7810 - val_auc: 0.7885\nEpoch 48/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4025 - accuracy: 0.8750 - auc: 0.8542\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 771us/step - loss: 0.4060 - accuracy: 0.8136 - auc: 0.8818 - val_loss: 0.5213 - val_accuracy: 0.7810 - val_auc: 0.7902\nEpoch 49/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.4923 - accuracy: 0.7812 - auc: 0.7996\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 754us/step - loss: 0.4069 - accuracy: 0.8292 - auc: 0.8825 - val_loss: 0.5249 - val_accuracy: 0.7762 - val_auc: 0.7918\nEpoch 50/50\n\r 1/27 [>.............................] - ETA: 0s - loss: 0.3923 - accuracy: 0.8125 - auc: 0.8968\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r27/27 [==============================] - 0s 767us/step - loss: 0.4097 - accuracy: 0.8208 - auc: 0.8832 - val_loss: 0.5203 - val_accuracy: 0.7762 - val_auc: 0.7904\n```\n:::\n:::\n\n\n## 6.6 可视化学习曲线\n\n观察训练过程中的损失和准确率变化：\n\n::: {#83227c24 .cell execution_count=6}\n``` {.python .cell-code}\n# 绘制学习曲线\nfig, axes = plt.subplots(1, 3, figsize=(18, 5))\n\n# 损失曲线\naxes[0].plot(history.history['loss'], label='训练损失', linewidth=2)\naxes[0].plot(history.history['val_loss'], label='验证损失', linewidth=2)\naxes[0].set_xlabel('训练轮数', fontsize=12)\naxes[0].set_ylabel('损失', fontsize=12)\naxes[0].set_title('损失曲线', fontsize=14)\naxes[0].legend()\naxes[0].grid(True, alpha=0.3)\n\n# 准确率曲线\naxes[1].plot(history.history['accuracy'], label='训练准确率', linewidth=2)\naxes[1].plot(history.history['val_accuracy'], label='验证准确率', linewidth=2)\naxes[1].set_xlabel('训练轮数', fontsize=12)\naxes[1].set_ylabel('准确率', fontsize=12)\naxes[1].set_title('准确率曲线', fontsize=14)\naxes[1].legend()\naxes[1].grid(True, alpha=0.3)\n\n# AUC 曲线\naxes[2].plot(history.history['auc'], label='训练 AUC', linewidth=2)\naxes[2].plot(history.history['val_auc'], label='验证 AUC', linewidth=2)\naxes[2].set_xlabel('训练轮数', fontsize=12)\naxes[2].set_ylabel('AUC', fontsize=12)\naxes[2].set_title('AUC 曲线', fontsize=14)\naxes[2].legend()\naxes[2].grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\nprint(\"学习曲线观察:\")\nprint(\"- 训练损失应该逐渐下降\")\nprint(\"- 验证损失开始上升可能表示过拟合\")\nprint(\"- 训练和验证指标差距过大也可能表示过拟合\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 35757 (\\N{CJK UNIFIED IDEOGRAPH-8BAD}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 32451 (\\N{CJK UNIFIED IDEOGRAPH-7EC3}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 36718 (\\N{CJK UNIFIED IDEOGRAPH-8F6E}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 25968 (\\N{CJK UNIFIED IDEOGRAPH-6570}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 25439 (\\N{CJK UNIFIED IDEOGRAPH-635F}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 22833 (\\N{CJK UNIFIED IDEOGRAPH-5931}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 26354 (\\N{CJK UNIFIED IDEOGRAPH-66F2}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 32447 (\\N{CJK UNIFIED IDEOGRAPH-7EBF}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 39564 (\\N{CJK UNIFIED IDEOGRAPH-9A8C}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 35777 (\\N{CJK UNIFIED IDEOGRAPH-8BC1}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 20934 (\\N{CJK UNIFIED IDEOGRAPH-51C6}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 30830 (\\N{CJK UNIFIED IDEOGRAPH-786E}) missing from current font.\n\n/var/folders/dh/sd70vd1d0jg1tkw7h3zwjqxr0000gn/T/ipykernel_149/2172824844.py:31: UserWarning:\n\nGlyph 29575 (\\N{CJK UNIFIED IDEOGRAPH-7387}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 25439 (\\N{CJK UNIFIED IDEOGRAPH-635F}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 22833 (\\N{CJK UNIFIED IDEOGRAPH-5931}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26354 (\\N{CJK UNIFIED IDEOGRAPH-66F2}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 32447 (\\N{CJK UNIFIED IDEOGRAPH-7EBF}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 35757 (\\N{CJK UNIFIED IDEOGRAPH-8BAD}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 32451 (\\N{CJK UNIFIED IDEOGRAPH-7EC3}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 36718 (\\N{CJK UNIFIED IDEOGRAPH-8F6E}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 25968 (\\N{CJK UNIFIED IDEOGRAPH-6570}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 39564 (\\N{CJK UNIFIED IDEOGRAPH-9A8C}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 35777 (\\N{CJK UNIFIED IDEOGRAPH-8BC1}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 20934 (\\N{CJK UNIFIED IDEOGRAPH-51C6}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 30830 (\\N{CJK UNIFIED IDEOGRAPH-786E}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 29575 (\\N{CJK UNIFIED IDEOGRAPH-7387}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](w6_practice_files/figure-html/cell-7-output-2.png){width=1719 height=470}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n学习曲线观察:\n- 训练损失应该逐渐下降\n- 验证损失开始上升可能表示过拟合\n- 训练和验证指标差距过大也可能表示过拟合\n```\n:::\n:::\n\n\n## 6.7 模型评估\n\n在训练集和测试集上评估模型性能：\n\n- 准确率 (Accuracy)\n- AUC (Area Under ROC Curve)\n- 分类报告：精确率、召回率、F1 分数\n\n::: {#474d56a4 .cell execution_count=7}\n``` {.python .cell-code}\n# 预测\ny_train_pred_prob = model.predict(X_train).flatten()\ny_test_pred_prob = model.predict(X_test).flatten()\n\ny_train_pred = (y_train_pred_prob > 0.5).astype(int)\ny_test_pred = (y_test_pred_prob > 0.5).astype(int)\n\n# 评估\nprint(\"=== 训练集 ===\")\nprint(f\"准确率: {accuracy_score(y_train, y_train_pred):.3f}\")\nprint(f\"AUC: {roc_auc_score(y_train, y_train_pred_prob):.3f}\")\n\nprint(\"\\n=== 测试集 ===\")\nprint(f\"准确率: {accuracy_score(y_test, y_test_pred):.3f}\")\nprint(f\"AUC: {roc_auc_score(y_test, y_test_pred_prob):.3f}\")\n\nprint(\"\\n分类报告:\")\nprint(classification_report(y_test, y_test_pred, target_names=['死亡', '存活']))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\r 1/33 [..............................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r33/33 [==============================] - 0s 254us/step\n\r1/9 [==>...........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r9/9 [==============================] - 0s 286us/step\n=== 训练集 ===\n准确率: 0.815\nAUC: 0.872\n\n=== 测试集 ===\n准确率: 0.851\nAUC: 0.861\n\n分类报告:\n              precision    recall  f1-score   support\n\n          死亡       0.84      0.93      0.89       162\n          存活       0.87      0.72      0.79       100\n\n    accuracy                           0.85       262\n   macro avg       0.86      0.83      0.84       262\nweighted avg       0.85      0.85      0.85       262\n\n```\n:::\n:::\n\n\n## 6.8 MLP vs 随机森林对比\n\n将 MLP 与传统的机器学习算法（随机森林）进行对比。\n\n**注意：** 随机森林不需要特征标准化，所以使用原始特征。\n\n::: {#0b0c68e6 .cell execution_count=8}\n``` {.python .cell-code}\n# 准备随机森林的数据（不需要标准化）\nX_train_orig, X_test_orig, _, _ = train_test_split(\n    df_clean.drop('Survived', axis=1).values,\n    df_clean['Survived'].astype(int).values,\n    test_size=0.2, random_state=42, stratify=df_clean['Survived'].astype(int).values\n)\n\n# 训练随机森林\nrf = RandomForestClassifier(n_estimators=100, max_depth=5, random_state=42)\nrf.fit(X_train_orig, y_train)\ny_test_pred_rf = rf.predict_proba(X_test_orig)[:, 1]\n\n# 计算 AUC\nmlp_auc = roc_auc_score(y_test, y_test_pred_prob)\nrf_auc = roc_auc_score(y_test, y_test_pred_rf)\n\n# 对比表格\ncomparison = pd.DataFrame({\n    '模型': ['MLP', '随机森林'],\n    '测试集 AUC': [mlp_auc, rf_auc]\n})\n\nprint(\"模型对比:\")\nprint(comparison.to_string(index=False))\nprint(f\"\\nMLP 优势: {mlp_auc - rf_auc:+.3f} (AUC 差异)\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n模型对比:\n  模型  测试集 AUC\n MLP 0.861451\n随机森林 0.888920\n\nMLP 优势: -0.027 (AUC 差异)\n```\n:::\n:::\n\n\n::: {#030c7eb8 .cell execution_count=9}\n``` {.python .cell-code}\n# ROC 曲线对比\nfpr_mlp, tpr_mlp, _ = roc_curve(y_test, y_test_pred_prob)\nfpr_rf, tpr_rf, _ = roc_curve(y_test, y_test_pred_rf)\n\nplt.figure(figsize=(10, 8))\nplt.plot(fpr_mlp, tpr_mlp, linewidth=3, label=f'MLP (AUC={mlp_auc:.3f})')\nplt.plot(fpr_rf, tpr_rf, linewidth=3, label=f'随机森林 (AUC={rf_auc:.3f})')\nplt.plot([0, 1], [0, 1], 'k--', linewidth=2, label='随机猜测')\nplt.xlabel('FPR (False Positive Rate)', fontsize=12)\nplt.ylabel('TPR (True Positive Rate)', fontsize=12)\nplt.title('MLP vs 随机森林 - ROC 曲线对比', fontsize=14)\nplt.legend(fontsize=11)\nplt.grid(True, alpha=0.3)\nplt.show()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 38543 (\\N{CJK UNIFIED IDEOGRAPH-968F}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26426 (\\N{CJK UNIFIED IDEOGRAPH-673A}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26862 (\\N{CJK UNIFIED IDEOGRAPH-68EE}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26519 (\\N{CJK UNIFIED IDEOGRAPH-6797}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 26354 (\\N{CJK UNIFIED IDEOGRAPH-66F2}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 32447 (\\N{CJK UNIFIED IDEOGRAPH-7EBF}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 23545 (\\N{CJK UNIFIED IDEOGRAPH-5BF9}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 27604 (\\N{CJK UNIFIED IDEOGRAPH-6BD4}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 29468 (\\N{CJK UNIFIED IDEOGRAPH-731C}) missing from current font.\n\n/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning:\n\nGlyph 27979 (\\N{CJK UNIFIED IDEOGRAPH-6D4B}) missing from current font.\n\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\nfindfont: Generic family 'sans-serif' not found because none of the following families were found: SimHei\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](w6_practice_files/figure-html/cell-10-output-2.png){width=815 height=676}\n:::\n:::\n\n\n## 小结\n\n**结论：** 在 Titanic 数据集上，随机森林通常表现略好于或持平于基础 MLP。这是正常的，因为：\n\n1. **数据集较小**：神经网络需要大量数据才能充分发挥优势\n2. **特征工程**：随机森林对特征预处理要求较低\n3. **模型复杂度**：我们使用的 MLP 结构相对简单\n\n**MLP 的优势将在更大规模的数据集和更复杂的任务中体现。**\n\n**练习任务：**\n\n- 尝试调整 MLP 的隐藏层神经元数量\n- 尝试不同的激活函数\n- 观察过拟合现象（增加 epochs）\n- 尝试其他数据集（如 MNIST 手写数字识别）\n\n**神经网络的关键概念：**\n\n- **层（Layers）**：神经网络的基本构建块\n- **激活函数（Activation）**：为网络引入非线性\n- **损失函数（Loss）**：衡量预测与真实值的差距\n- **优化器（Optimizer）**：更新网络参数的算法\n- **批次（Batch）**：每次更新使用的样本数量\n- **轮次（Epoch）**：完整遍历训练集的次数\n\n**超参数调优建议：**\n\n- **网络结构**：尝试不同的隐藏层数量和神经元数量\n- **学习率**：太大会震荡，太小会收敛慢\n- **批次大小**：通常 32-128 之间\n- **正则化**：Dropout、L1/L2 正则化防止过拟合\n- **早停（Early Stopping）**：监控验证损失，防止过拟合\n\n",
    "supporting": [
      "w6_practice_files"
    ],
    "filters": [],
    "includes": {}
  }
}